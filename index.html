<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>å…¨çƒç­¾è¯å…ç­¾æ”¿ç­–åœ°å›¾æ€»è§ˆ(2026ç‰ˆ)</title>

  <!-- Google Analytics -->
  <!-- è¯·å°† G-XXXXXXXXXX æ›¿æ¢ä¸ºæ‚¨çš„Google Analyticsè·Ÿè¸ªID -->
  <!-- è·å–è·Ÿè¸ªIDï¼šhttps://analytics.google.com/ -->
  <!--
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-XXXXXXXXXX"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-XXXXXXXXXX');
  </script>
  -->

  <!-- å¼•å…¥ç°ä»£å­—ä½“ -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&family=Noto+Sans+SC:wght@400;500;700&display=swap" rel="stylesheet">
  
  <style>
    :root {
      --bg-main: #f1f5f9;
      --card-bg: #ffffff;
      --tab-active: #3b82f6;
      --tab-inactive: #64748b;
      --tab-hover: #94a3b8;
    }

    * {
      box-sizing: border-box;
    }

    body {
      font-family: 'Inter', 'Noto Sans SC', sans-serif;
      background-color: var(--bg-main);
      margin: 0;
      padding: 20px;
      color: #1e293b;
    }

    .container {
      max-width: 1600px;
      margin: 0 auto;
      background: var(--card-bg);
      border-radius: 20px;
      box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.05), 0 8px 10px -6px rgba(0, 0, 0, 0.05);
      overflow: hidden;
    }

    .header {
      padding: 30px;
      text-align: center;
      border-bottom: 1px solid #e2e8f0;
    }

    .header h1 {
      margin: 0;
      font-size: 28px;
      font-weight: 700;
      color: #0f172a;
      letter-spacing: -0.025em;
    }

    .header p {
      margin: 8px 0 0;
      color: #64748b;
      font-size: 14px;
    }

    .header-content {
      position: relative;
    }

    .star-button {
      position: absolute;
      top: 0;
      right: 0;
      background: linear-gradient(135deg, #ff6b6b, #ee5a52);
      color: white;
      border: none;
      border-radius: 25px;
      padding: 12px 20px;
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 8px;
      box-shadow: 0 4px 12px rgba(238, 90, 82, 0.3);
      transition: all 0.3s ease;
      text-decoration: none;
    }

    .star-button:hover {
      background: linear-gradient(135deg, #ee5a52, #dc4545);
      box-shadow: 0 6px 16px rgba(238, 90, 82, 0.4);
      transform: translateY(-2px);
    }

    .star-button:active {
      transform: translateY(0);
      box-shadow: 0 2px 8px rgba(238, 90, 82, 0.3);
    }

    .star-icon {
      font-size: 16px;
    }

    .tabs {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      padding: 20px 30px;
      background: #f8fafc;
      border-bottom: 1px solid #e2e8f0;
    }

    .tab-button {
      padding: 10px 20px;
      font-size: 14px;
      font-weight: 500;
      color: var(--tab-inactive);
      background: transparent;
      border: 1px solid #e2e8f0;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.2s;
      font-family: 'Inter', 'Noto Sans SC', sans-serif;
    }

    .tab-button:hover {
      color: var(--tab-active);
      border-color: var(--tab-active);
      background: rgba(59, 130, 246, 0.05);
    }

    .tab-button.active {
      color: #ffffff;
      background: var(--tab-active);
      border-color: var(--tab-active);
    }

    .map-container {
      display: none;
      padding: 30px;
      position: relative;
    }

    .map-container.active {
      display: block;
    }

    .map-header {
      margin-bottom: 25px;
      text-align: center;
    }

    .map-header h2 {
      margin: 0;
      font-size: 24px;
      font-weight: 700;
      color: #0f172a;
      letter-spacing: -0.025em;
    }

    .map-header p {
      margin: 5px 0 0;
      color: #64748b;
      font-size: 14px;
    }

    .map-header-watermark {
      margin: 8px 0 0;
      color: #374151;
      font-size: 16px;
      line-height: 1.6;
      font-family: 'Inter', 'Noto Sans SC', sans-serif;
    }

    .chartdiv {
      width: 100%;
      height: 700px;
      background-color: #ffffff;
      border-radius: 12px;
    }

    /* è‡ªå®šä¹‰å¯¼å‡ºæŒ‰é’®æ ·å¼ */
    .amcharts-export-menu {
      top: 10px !important;
      right: 10px !important;
    }


    /* è°ƒè‰²ç›˜æ ·å¼ */
    .color-palette {
      margin-top: 20px;
      padding: 20px;
      background: #f8fafc;
      border-radius: 12px;
      border: 1px solid #e2e8f0;
    }

    .color-palette-title {
      font-size: 16px;
      font-weight: 600;
      color: #0f172a;
      margin-bottom: 15px;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .color-palette-title::before {
      content: "ğŸ¨";
      font-size: 20px;
    }

    .color-palette-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 12px;
    }

    .color-palette-item {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 8px;
      background: white;
      border-radius: 8px;
      border: 1px solid #e2e8f0;
      transition: all 0.2s;
    }

    .color-palette-item:hover {
      border-color: #3b82f6;
      box-shadow: 0 2px 4px rgba(59, 130, 246, 0.1);
    }

    .color-palette-label {
      flex: 1;
      font-size: 14px;
      color: #1e293b;
      font-weight: 500;
    }

    .color-palette-input {
      width: 50px;
      height: 36px;
      border: 2px solid #e2e8f0;
      border-radius: 6px;
      cursor: pointer;
      transition: all 0.2s;
    }

    .color-palette-input:hover {
      border-color: #3b82f6;
      transform: scale(1.05);
    }

    .color-palette-reset {
      margin-top: 15px;
      padding: 10px 20px;
      background: #64748b;
      color: white;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-size: 14px;
      font-weight: 500;
      transition: all 0.2s;
      width: 100%;
    }

    .color-palette-reset:hover {
      background: #475569;
    }

    /* å“åº”å¼è°ƒæ•´ */
    @media (max-width: 768px) {
      .container {
        border-radius: 0;
        margin: -20px;
      }

      .header {
        padding: 20px 15px;
      }

      .header h1 {
        font-size: 22px;
      }

      .tabs {
        padding: 15px;
        gap: 6px;
      }

      .tab-button {
        padding: 8px 12px;
        font-size: 12px;
        flex: 1;
        min-width: calc(50% - 3px);
      }

      .map-container {
        padding: 15px;
      }

      .chartdiv {
        height: 500px;
      }
    }

    @media (max-width: 480px) {
      .tab-button {
        min-width: 100%;
      }
    }
  </style>
</head>
<body>

  <div class="container">
    <div class="header">
      <div class="header-content">
        <h1>å…¨çƒç­¾è¯å…ç­¾æ”¿ç­–åœ°å›¾æ€»è§ˆ</h1>
        <p>2026ç‰ˆ Â· ä¸€é”®åˆ‡æ¢æŸ¥çœ‹å„ç±»ç­¾è¯å…ç­¾æ”¿ç­–åœ°å›¾</p>
        <a href="https://github.com/figsama/2026qzdt" target="_blank" class="star-button">
          <span class="star-icon">â­</span>
          Star on GitHub
        </a>
      </div>
    </div>

    <div class="tabs">
      <button class="tab-button active" data-tab="global">å…¨çƒæ±‡æ€»</button>
      <button class="tab-button" data-tab="china">ä¸­å›½æŠ¤ç…§</button>
      <button class="tab-button" data-tab="us">ç¾å›½ç­¾è¯</button>
      <button class="tab-button" data-tab="uk">è‹±å›½ç­¾è¯</button>
      <button class="tab-button" data-tab="japan">æ—¥æœ¬ç­¾è¯</button>
      <button class="tab-button" data-tab="australia">æ¾³æ´²ç­¾è¯</button>
      <button class="tab-button" data-tab="schengen">ç”³æ ¹ç­¾è¯</button>
      <button class="tab-button" data-tab="analytics">è®¿é—®ç»Ÿè®¡</button>
    </div>

    <!-- å…¨çƒæ±‡æ€»åœ°å›¾ -->
    <div id="global" class="map-container active">
      <div class="map-header">
        <h2>å…¨çƒç­¾è¯å…ç­¾æ”¿ç­–æ±‡æ€»åœ°å›¾</h2>
        <p>2026ç‰ˆ Â· æ±‡æ€»ä¸­å›½æŠ¤ç…§å…ç­¾/è½åœ°ç­¾/ç”µå­ç­¾åŠç¾ç­¾/ç”³æ ¹ç­¾/æ—¥ç­¾/è‹±ç­¾/æ¾³ç­¾å…ç­¾æ”¿ç­–</p>
        <div class="map-header-watermark">å°çº¢ä¹¦ï¼šæ— èŠ±æœå…ˆç”Ÿ https://figsama.github.io/2026qzdt/</div>
      </div>
      <div id="chartdiv-global" class="chartdiv"></div>
      <div id="color-palette-global" class="color-palette"></div>
    </div>

    <!-- ä¸­å›½æŠ¤ç…§åœ°å›¾ -->
    <div id="china" class="map-container">
      <div class="map-header">
        <h2>ä¸­å›½æŠ¤ç…§å…¨çƒç­¾è¯æ”¿ç­–åœ°å›¾</h2>
        <p>å®æ—¶æ›´æ–° Â· å…ç­¾ / è½åœ°ç­¾ / ç”µå­ç­¾æ”¿ç­–åˆ†å¸ƒ</p>
        <div class="map-header-watermark">å°çº¢ä¹¦ï¼šæ— èŠ±æœå…ˆç”Ÿ https://figsama.github.io/2026qzdt/</div>
      </div>
      <div id="chartdiv-china" class="chartdiv"></div>
      <div id="color-palette-china" class="color-palette"></div>
    </div>

    <!-- ç¾å›½ç­¾è¯åœ°å›¾ -->
    <div id="us" class="map-container">
      <div class="map-header">
        <h2>æŒç¾å›½ç­¾è¯å¯å…ç­¾å…¨çƒçš„å›½å®¶å’Œåœ°åŒº</h2>
        <p>2026ç‰ˆ Â· å…ç­¾å›½å®¶ / æœ‰æ¡ä»¶è¿‡å¢ƒå…ç­¾æ”¿ç­–åˆ†å¸ƒ</p>
        <div class="map-header-watermark">å°çº¢ä¹¦ï¼šæ— èŠ±æœå…ˆç”Ÿ https://figsama.github.io/2026qzdt/</div>
      </div>
      <div id="chartdiv-us" class="chartdiv"></div>
      <div id="color-palette-us" class="color-palette"></div>
    </div>

    <!-- è‹±å›½ç­¾è¯åœ°å›¾ -->
    <div id="uk" class="map-container">
      <div class="map-header">
        <h2>æŒè‹±å›½ç­¾è¯å¯å…ç­¾å…¨çƒçš„å›½å®¶å’Œåœ°åŒº</h2>
        <p>2026ç‰ˆ Â· å…ç­¾å›½å®¶ / æœ‰æ¡ä»¶è¿‡å¢ƒå…ç­¾æ”¿ç­–åˆ†å¸ƒ</p>
        <div class="map-header-watermark">å°çº¢ä¹¦ï¼šæ— èŠ±æœå…ˆç”Ÿ https://figsama.github.io/2026qzdt/</div>
      </div>
      <div id="chartdiv-uk" class="chartdiv"></div>
      <div id="color-palette-uk" class="color-palette"></div>
    </div>

    <!-- æ—¥æœ¬ç­¾è¯åœ°å›¾ -->
    <div id="japan" class="map-container">
      <div class="map-header">
        <h2>æŒæ—¥æœ¬ç­¾è¯å¯å…ç­¾å…¨çƒçš„å›½å®¶å’Œåœ°åŒº</h2>
        <p>2026ç‰ˆ Â· å¤šæ¬¡æ—¥æœ¬ç­¾è¯å…ç­¾æ”¿ç­–åˆ†å¸ƒ</p>
        <div class="map-header-watermark">å°çº¢ä¹¦ï¼šæ— èŠ±æœå…ˆç”Ÿ https://figsama.github.io/2026qzdt/</div>
      </div>
      <div id="chartdiv-japan" class="chartdiv"></div>
      <div id="color-palette-japan" class="color-palette"></div>
    </div>

    <!-- æ¾³æ´²ç­¾è¯åœ°å›¾ -->
    <div id="australia" class="map-container">
      <div class="map-header">
        <h2>æŒæ¾³æ´²ç­¾è¯å¯å…ç­¾å…¨çƒçš„å›½å®¶å’Œåœ°åŒº</h2>
        <p>2026ç‰ˆ Â· å…ç­¾å›½å®¶ / æœ‰æ¡ä»¶è¿‡å¢ƒå…ç­¾æ”¿ç­–åˆ†å¸ƒ</p>
        <div class="map-header-watermark">å°çº¢ä¹¦ï¼šæ— èŠ±æœå…ˆç”Ÿ https://figsama.github.io/2026qzdt/</div>
      </div>
      <div id="chartdiv-australia" class="chartdiv"></div>
      <div id="color-palette-australia" class="color-palette"></div>
    </div>

    <!-- ç”³æ ¹ç­¾è¯åœ°å›¾ -->
    <div id="schengen" class="map-container">
      <div class="map-header">
        <h2>æŒç”³æ ¹ç­¾è¯å¯å…ç­¾å…¨çƒçš„å›½å®¶å’Œåœ°åŒº</h2>
        <p>2026ç‰ˆ Â· ç”³æ ¹åŒº / å…ç­¾å›½å®¶ / æœ‰æ¡ä»¶è¿‡å¢ƒå…ç­¾æ”¿ç­–åˆ†å¸ƒ</p>
        <div class="map-header-watermark">å°çº¢ä¹¦ï¼šæ— èŠ±æœå…ˆç”Ÿ https://figsama.github.io/2026qzdt/</div>
      </div>
      <div id="chartdiv-schengen" class="chartdiv"></div>
      <div id="color-palette-schengen" class="color-palette"></div>
    </div>

    <!-- è®¿é—®ç»Ÿè®¡åœ°å›¾ -->
    <div id="analytics" class="map-container">
      <div class="map-header">
        <h2>ç½‘ç«™è®¿é—®ç»Ÿè®¡</h2>
        <p>è®¿é—®è€…IPåœ°ç†ä½ç½®åˆ†å¸ƒ</p>
        <div class="map-header-watermark">å°çº¢ä¹¦ï¼šæ— èŠ±æœå…ˆç”Ÿ https://figsama.github.io/2026qzdt/</div>
      </div>
      <div id="chartdiv-analytics" class="chartdiv"></div>
      <div id="analytics-stats" style="margin-top: 20px; padding: 20px; background: #f8fafc; border-radius: 12px;">
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 20px;">
          <div style="background: white; padding: 15px; border-radius: 8px; text-align: center;">
            <div style="font-size: 24px; font-weight: 700; color: #3b82f6;" id="stat-total">0</div>
            <div style="font-size: 14px; color: #64748b; margin-top: 5px;">æ€»è®¿é—®é‡</div>
          </div>
          <div style="background: white; padding: 15px; border-radius: 8px; text-align: center;">
            <div style="font-size: 24px; font-weight: 700; color: #10b981;" id="stat-unique">0</div>
            <div style="font-size: 14px; color: #64748b; margin-top: 5px;">ç‹¬ç«‹IP</div>
          </div>
          <div style="background: white; padding: 15px; border-radius: 8px; text-align: center;">
            <div style="font-size: 24px; font-weight: 700; color: #f59e0b;" id="stat-countries">0</div>
            <div style="font-size: 14px; color: #64748b; margin-top: 5px;">å›½å®¶/åœ°åŒº</div>
          </div>
        </div>
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 15px;">
          <div style="background: white; padding: 15px; border-radius: 8px;">
            <h3 style="margin: 0 0 15px; font-size: 16px; font-weight: 600;">è®¿é—®æœ€å¤šçš„å›½å®¶</h3>
            <div id="stat-top-countries" style="font-size: 14px; line-height: 2;"></div>
          </div>
          <div style="background: white; padding: 15px; border-radius: 8px;">
            <h3 style="margin: 0 0 15px; font-size: 16px; font-weight: 600;">è®¿é—®æœ€å¤šçš„åŸå¸‚</h3>
            <div id="stat-top-cities" style="font-size: 14px; line-height: 2;"></div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script src="https://www.amcharts.com/lib/3/ammap.js"></script>
  <script src="https://www.amcharts.com/lib/3/maps/js/worldHigh.js"></script>
  <script src="https://www.amcharts.com/lib/3/plugins/export/export.min.js"></script>
  <link rel="stylesheet" href="https://www.amcharts.com/lib/3/plugins/export/export.css" type="text/css" media="all" />
  <script src="https://www.amcharts.com/lib/3/themes/light.js"></script>
  
  <!-- Firebase SDK v9+ (CDNå…¼å®¹ç‰ˆæœ¬) -->
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyCYSpOk7NTqS9hzZ9OSBD2t3vc2OMgMjRg",
      authDomain: "visitmap-f9bb2.firebaseapp.com",
      projectId: "visitmap-f9bb2",
      storageBucket: "visitmap-f9bb2.firebasestorage.app",
      messagingSenderId: "737276588756",
      appId: "1:737276588756:web:bb6f3872edae53ad2e4141",
      measurementId: "G-L1102C4EC6"
    };
    
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();
  </script>

  <script>
    // å­˜å‚¨æ‰€æœ‰åœ°å›¾å®ä¾‹
    const maps = {};
    
    // é¢œè‰²è‡ªå®šä¹‰åŠŸèƒ½
    const colorCustomizer = {
      currentMap: null,
      currentLegendTitle: null,
      currentColorKey: null,
      
      // ä¿å­˜é¢œè‰²åˆ°localStorage
      saveColor(mapType, colorKey, color) {
        const key = `visa_map_color_${mapType}_${colorKey}`;
        localStorage.setItem(key, color);
      },
      
      // ä»localStorageåŠ è½½é¢œè‰²
      loadColor(mapType, colorKey, defaultColor) {
        const key = `visa_map_color_${mapType}_${colorKey}`;
        return localStorage.getItem(key) || defaultColor;
      },
      
      // åŠ è½½æ‰€æœ‰ä¿å­˜çš„é¢œè‰²
      loadAllColors(mapType, defaultColors) {
        const colors = {};
        for (const [key, value] of Object.entries(defaultColors)) {
          colors[key] = this.loadColor(mapType, key, value);
        }
        return colors;
      },
      
      // é‡ç½®æ‰€æœ‰é¢œè‰²
      resetColors(mapType) {
        const keys = Object.keys(localStorage);
        keys.forEach(key => {
          if (key.startsWith(`visa_map_color_${mapType}_`)) {
            localStorage.removeItem(key);
          }
        });
      },
      
      // åˆå§‹åŒ–è°ƒè‰²ç›˜
      initColorPalette(mapType, legendTitleToColorKey, COLORS) {
        const paletteContainer = document.getElementById(`color-palette-${mapType}`);
        if (!paletteContainer) return;
        
        // æ¸…ç©ºå®¹å™¨
        paletteContainer.innerHTML = '';
        
        // åˆ›å»ºæ ‡é¢˜
        const title = document.createElement('div');
        title.className = 'color-palette-title';
        title.textContent = 'è‡ªå®šä¹‰é¢œè‰²';
        paletteContainer.appendChild(title);
        
        // åˆ›å»ºé¢œè‰²ç½‘æ ¼
        const grid = document.createElement('div');
        grid.className = 'color-palette-grid';
        
        // ä¸ºæ¯ä¸ªé¢œè‰²ç±»åˆ«åˆ›å»ºè°ƒè‰²ç›˜é¡¹
        for (const [legendTitle, colorKey] of Object.entries(legendTitleToColorKey)) {
          if (!COLORS[colorKey]) continue;
          
          const item = document.createElement('div');
          item.className = 'color-palette-item';
          
          const label = document.createElement('div');
          label.className = 'color-palette-label';
          label.textContent = legendTitle;
          
          const colorInput = document.createElement('input');
          colorInput.type = 'color';
          colorInput.className = 'color-palette-input';
          colorInput.value = COLORS[colorKey];
          
          // æ·»åŠ é¢œè‰²æ›´æ”¹äº‹ä»¶ç›‘å¬å™¨
          colorInput.addEventListener('change', function() {
            const newColor = this.value;
            colorCustomizer.saveColor(mapType, colorKey, newColor);
            
            // é‡æ–°åˆå§‹åŒ–åœ°å›¾
            delete maps[mapType];
            const mapContainer = document.getElementById(mapType);
            if (mapContainer) {
              mapContainer.classList.add('active');
            }
            initMap(mapType);
          });
          
          item.appendChild(label);
          item.appendChild(colorInput);
          grid.appendChild(item);
        }
        
        paletteContainer.appendChild(grid);
        
        // æ·»åŠ é‡ç½®æŒ‰é’®
        const resetBtn = document.createElement('button');
        resetBtn.className = 'color-palette-reset';
        resetBtn.textContent = 'é‡ç½®æ‰€æœ‰é¢œè‰²';
        resetBtn.addEventListener('click', function() {
          colorCustomizer.resetColors(mapType);
          delete maps[mapType];
          const mapContainer = document.getElementById(mapType);
          if (mapContainer) {
            mapContainer.classList.add('active');
          }
          initMap(mapType);
        });
        
        paletteContainer.appendChild(resetBtn);
      },
      
      // é‡ç½®å½“å‰åœ°å›¾çš„æ‰€æœ‰é¢œè‰²
      resetMapColors(mapType) {
        this.resetColors(mapType);
        delete maps[mapType];
        const mapContainer = document.getElementById(mapType);
        if (mapContainer) {
          mapContainer.classList.add('active');
        }
        initMap(mapType);
      }
    };
    
    // è®¿é—®ç»Ÿè®¡åŠŸèƒ½
    const visitTracker = {
      // ä½¿ç”¨ JSONP è·å–IPåœ°ç†ä½ç½®ï¼ˆç»•è¿‡CORSé™åˆ¶ï¼‰
      getIPLocationJSONP() {
        return new Promise((resolve, reject) => {
          // ä½¿ç”¨ ip-api.com çš„ JSONP æ¥å£
          const callbackName = 'ipLocationCallback_' + Date.now();
          const script = document.createElement('script');
          let completed = false;
          
          window[callbackName] = (data) => {
            if (completed) return;
            completed = true;
            
            delete window[callbackName];
            if (script.parentNode) {
              document.body.removeChild(script);
            }
            
            if (data.status === 'success') {
              resolve({
                ip: data.query || 'unknown',
                country: data.country || 'China',
                countryCode: data.countryCode || 'CN',
                city: data.city || 'Unknown',
                latitude: data.lat || 0,
                longitude: data.lon || 0
              });
            } else {
              reject(new Error('APIè¿”å›å¤±è´¥'));
            }
          };
          
          script.src = `http://ip-api.com/json/?callback=${callbackName}&fields=status,query,country,countryCode,city,lat,lon`;
          script.onerror = () => {
            if (completed) return;
            completed = true;
            
            delete window[callbackName];
            if (script.parentNode) {
              document.body.removeChild(script);
            }
            reject(new Error('JSONPè¯·æ±‚å¤±è´¥'));
          };
          
          document.body.appendChild(script);
          
          // 5ç§’è¶…æ—¶ï¼ˆå‡å°‘ç­‰å¾…æ—¶é—´ï¼‰
          setTimeout(() => {
            if (!completed && window[callbackName]) {
              completed = true;
              delete window[callbackName];
              if (script.parentNode) {
                document.body.removeChild(script);
              }
              reject(new Error('è¯·æ±‚è¶…æ—¶'));
            }
          }, 5000);
        });
      },
      
      // ä½¿ç”¨æ”¯æŒ CORS çš„ API è·å–IPåœ°ç†ä½ç½®ï¼ˆå¤‡ç”¨æ–¹æ¡ˆï¼‰
      async getIPLocationCORS() {
        const apis = [
          // ipapi.co - å…è´¹ä¸”ç¨³å®š
          {
            name: 'ipapi.co',
            url: 'https://ipapi.co/json/',
            parser: (data) => ({
              ip: data.ip,
              country: data.country_name,
              countryCode: data.country_code,
              city: data.city,
              latitude: data.latitude,
              longitude: data.longitude
            })
          },
          // ipwhois.app - å¤‡ç”¨
          {
            name: 'ipwhois.app',
            url: 'https://ipwhois.app/json/',
            parser: (data) => ({
              ip: data.ip,
              country: data.country,
              countryCode: data.country_code,
              city: data.city,
              latitude: data.latitude,
              longitude: data.longitude
            })
          },
          // ipify + ipapi - ç»„åˆæ–¹æ¡ˆ
          {
            name: 'ipify',
            url: 'https://api.ipify.org?format=json',
            parser: async (data) => {
              // åªè·å–IP,ä¸è·å–ä½ç½®ä¿¡æ¯(ä½ç½®ç”±å…¶ä»–APIæä¾›)
              return {
                ip: data.ip,
                country: 'China',
                countryCode: 'CN',
                city: 'Unknown',
                latitude: 35.8617,
                longitude: 104.1954
              };
            }
          }
        ];
        
        for (const api of apis) {
          try {
            const controller = new AbortController();
            const timeoutId = setTimeout(() => controller.abort(), 5000);
            
            const response = await fetch(api.url, {
              method: 'GET',
              headers: {
                'Accept': 'application/json'
              },
              signal: controller.signal
            });
            
            clearTimeout(timeoutId);
            
            if (!response.ok) {
              console.warn(`API ${api.name} è¿”å›çŠ¶æ€ ${response.status}`);
              continue;
            }
            
            const data = await response.json();
            const parsed = typeof api.parser === 'function' 
              ? await api.parser(data) 
              : api.parser(data);
            
            // æ£€æŸ¥æ•°æ®æ˜¯å¦æœ‰æ•ˆ
            if (parsed.ip && parsed.ip !== 'unknown') {
              console.log(`âœ“ ä½¿ç”¨ ${api.name} æˆåŠŸè·å–IPä¿¡æ¯`);
              return parsed;
            }
          } catch (error) {
            if (error.name === 'AbortError') {
              console.warn(`API ${api.name} è¶…æ—¶`);
            } else {
              console.warn(`API ${api.name} å¤±è´¥:`, error.message);
            }
            continue;
          }
        }
        
        throw new Error('æ‰€æœ‰CORS APIéƒ½å¤±è´¥');
      },
      
      // è·å–è®¿é—®è€…IPå’Œåœ°ç†ä½ç½®
      async trackVisit() {
        let locationData = null;
        
        // ä¼˜å…ˆå°è¯• CORS APIï¼ˆæ›´å¯é ï¼‰
        try {
          locationData = await this.getIPLocationCORS();
          console.log('âœ“ è·å–IPåœ°ç†ä½ç½®æˆåŠŸ');
        } catch (error) {
          console.warn('âš  CORS API å¤±è´¥ï¼Œå°è¯• JSONP:', error.message);
          
          // å¤‡ç”¨æ–¹æ¡ˆ: å°è¯• JSONP
          try {
            locationData = await this.getIPLocationJSONP();
            console.log('âœ“ ä½¿ç”¨ JSONP è·å–IPåœ°ç†ä½ç½®æˆåŠŸ');
          } catch (error2) {
            console.warn('âš  JSONP ä¹Ÿå¤±è´¥:', error2.message);
          }
        }
        
        // å¦‚æœæ‰€æœ‰æ–¹æ³•éƒ½å¤±è´¥ï¼Œä½¿ç”¨åŸºæœ¬ä¿¡æ¯ï¼ˆé»˜è®¤æ˜¾ç¤ºä¸ºä¸­å›½ï¼‰
        if (!locationData) {
          console.info('â„¹ ä½¿ç”¨é»˜è®¤åœ°ç†ä½ç½®ä¿¡æ¯ï¼ˆä¸­å›½ï¼‰');
          locationData = {
            ip: 'unknown',
            country: 'China',
            countryCode: 'CN',
            city: 'Unknown',
            latitude: 35.8617,
            longitude: 104.1954
          };
        }
        
        // å¤„ç†åŸå¸‚åç§°ï¼šå¦‚æœæ˜¯ä¸­å›½çš„ Unknown åŸå¸‚ï¼Œæ˜¾ç¤ºä¸º "Unknown city in China"
        let city = locationData.city || 'Unknown';
        const country = locationData.country || 'China';
        if ((country === 'China' || country === 'ä¸­å›½') && (city === 'Unknown' || !city)) {
          city = 'Unknown city in China';
        }
        
        const visitData = {
          ip: locationData.ip || 'unknown',
          country: country,
          countryCode: locationData.countryCode || 'CN',
          city: city,
          latitude: locationData.latitude || 35.8617,
          longitude: locationData.longitude || 104.1954,
          timestamp: new Date().toISOString(),
          userAgent: navigator.userAgent,
          referrer: document.referrer || 'direct'
        };
        
        // ä¿å­˜è®¿é—®æ•°æ®åˆ°Firebase
        await this.saveVisit(visitData);
        
        return visitData;
      },
      
      // ä¿å­˜è®¿é—®æ•°æ®åˆ°Firebase
      async saveVisit(visitData) {
        if (typeof db === 'undefined') {
          console.warn('Firebaseæœªåˆå§‹åŒ–');
          return;
        }
        
        try {
          // æ£€æŸ¥æ˜¯å¦å·²å­˜åœ¨ç›¸åŒIPçš„è®¿é—®ï¼ˆé¿å…é‡å¤è®°å½•ï¼‰
          const today = new Date().toDateString();
          const visitsRef = db.collection('visits');
          const snapshot = await visitsRef
            .where('ip', '==', visitData.ip)
            .where('date', '==', today)
            .limit(1)
            .get();
          
          if (snapshot.empty) {
            // æ·»åŠ æ—¥æœŸå­—æ®µç”¨äºæŸ¥è¯¢
            visitData.date = today;
            visitData.createdAt = firebase.firestore.FieldValue.serverTimestamp();
            await visitsRef.add(visitData);
          }
        } catch (error) {
          if (error.code === 'permission-denied') {
            console.error('Firestore æƒé™é”™è¯¯: è¯·æ£€æŸ¥å®‰å…¨è§„åˆ™é…ç½®');
            console.error('è¯·å‚è€ƒ FIRESTORE_RULES.md æ–‡ä»¶é…ç½®å®‰å…¨è§„åˆ™');
            console.error('é”™è¯¯è¯¦æƒ…:', error.message);
          } else {
            console.error('ä¿å­˜åˆ°Firebaseå¤±è´¥:', error);
          }
        }
      },
      
      // ä»Firebaseè·å–æ‰€æœ‰è®¿é—®æ•°æ®å¹¶åœ¨å®¢æˆ·ç«¯èšåˆï¼ˆå…è´¹æ–¹æ¡ˆï¼‰
      async getAggregatedStats() {
        if (typeof db === 'undefined') {
          console.warn('Firebaseæœªé…ç½®ï¼Œæ— æ³•ä»äº‘ç«¯è·å–æ•°æ®');
          return null;
        }
        
        try {
          // ç›´æ¥ä» visits é›†åˆè¯»å–æ‰€æœ‰è®¿é—®æ•°æ®ï¼ˆéœ€è¦å®‰å…¨è§„åˆ™å…è®¸è¯»å–ï¼‰
          const snapshot = await db.collection('visits')
            .limit(10000) // é™åˆ¶æœ€å¤š10000æ¡è®°å½•
            .get();
          
          if (snapshot.empty) {
            console.warn('æš‚æ— è®¿é—®æ•°æ®');
            return null;
          }
          
          const visits = [];
          snapshot.forEach(doc => {
            const data = doc.data();
            const createdAt = data.createdAt?.toDate ? data.createdAt.toDate() : (data.timestamp ? new Date(data.timestamp) : new Date());
            visits.push({
              ...data,
              id: doc.id,
              timestamp: createdAt.toISOString(),
              createdAt: createdAt
            });
          });
          
          // åœ¨å®¢æˆ·ç«¯èšåˆæ•°æ®
          const stats = this.getStatsFromVisits(visits);
          
          // æ·»åŠ  countryVisits ç”¨äºåœ°å›¾æ˜¾ç¤º
          stats.countryVisits = {};
          visits.forEach(visit => {
            // ç»Ÿä¸€å¤„ç† Unknown å’Œ XXï¼Œæ˜ å°„åˆ°ä¸­å›½
            let countryCode = visit.countryCode || 'CN';
            let country = visit.country || 'China';
            
            // å¦‚æœ countryCode æ˜¯ XX æˆ– country æ˜¯ Unknownï¼Œç»Ÿä¸€æ˜ å°„åˆ°ä¸­å›½
            if (countryCode === 'XX' || country === 'Unknown' || !countryCode || !country) {
              countryCode = 'CN';
              country = 'China';
            }
            
            if (!stats.countryVisits[countryCode]) {
              stats.countryVisits[countryCode] = {
                count: 0,
                country: country
              };
            }
            stats.countryVisits[countryCode].count++;
          });
          
          console.log('æˆåŠŸèšåˆç»Ÿè®¡æ•°æ®:', {
            totalVisits: stats.totalVisits,
            uniqueIPs: stats.uniqueIPs,
            countriesCount: Object.keys(stats.countries).length
          });
          
          return stats;
        } catch (error) {
          console.error('ä»Firebaseè·å–è®¿é—®æ•°æ®å¤±è´¥:', error);
          console.error('é”™è¯¯è¯¦æƒ…:', {
            code: error.code,
            message: error.message
          });
          
          // å¦‚æœæ˜¯æƒé™é”™è¯¯ï¼Œæç¤ºç”¨æˆ·é…ç½®å®‰å…¨è§„åˆ™
          if (error.code === 'permission-denied') {
            console.error('æƒé™é”™è¯¯: è¯·ä¿®æ”¹ Firestore å®‰å…¨è§„åˆ™ï¼Œå…è®¸è¯»å– visits é›†åˆ');
            console.error('å‚è€ƒ FREE_FIRESTORE_RULES.md æ–‡ä»¶');
          }
          
          return null;
        }
      },
      
      // ä»æŒ‡å®šçš„è®¿é—®æ•°æ®æ•°ç»„è®¡ç®—ç»Ÿè®¡
      getStatsFromVisits(visits) {
        const stats = {
          totalVisits: visits.length,
          uniqueIPs: new Set(visits.map(v => v.ip)).size,
          countries: {},
          cities: {},
          visitsByDate: {},
          topCountries: [],
          topCities: []
        };
        
        visits.forEach(visit => {
          // ç»Ÿè®¡å›½å®¶ï¼ˆç»Ÿä¸€å¤„ç† Unknown ä¸ºä¸­å›½ï¼‰
          let country = visit.country || 'China';
          if (country === 'Unknown' || !country) {
            country = 'China';
          }
          stats.countries[country] = (stats.countries[country] || 0) + 1;
          
          // ç»Ÿè®¡åŸå¸‚ï¼ˆå¦‚æœæ˜¯ä¸­å›½çš„ Unknown åŸå¸‚ï¼Œæ˜¾ç¤ºä¸º "Unknown city in China"ï¼‰
          let city = visit.city || 'Unknown';
          if ((country === 'China' || country === 'ä¸­å›½') && (city === 'Unknown' || !city)) {
            city = 'Unknown city in China';
          }
          stats.cities[city] = (stats.cities[city] || 0) + 1;
          
          // ç»Ÿè®¡æ—¥æœŸ
          const date = new Date(visit.timestamp || visit.createdAt?.toDate?.() || visit.createdAt || Date.now()).toDateString();
          stats.visitsByDate[date] = (stats.visitsByDate[date] || 0) + 1;
        });
        
        // è·å–è®¿é—®æœ€å¤šçš„å›½å®¶
        stats.topCountries = Object.entries(stats.countries)
          .sort((a, b) => b[1] - a[1])
          .slice(0, 10)
          .map(([country, count]) => ({ country, count }));
        
        // è·å–è®¿é—®æœ€å¤šçš„åŸå¸‚
        stats.topCities = Object.entries(stats.cities)
          .sort((a, b) => b[1] - a[1])
          .slice(0, 10)
          .map(([city, count]) => ({ city, count }));
        
        return stats;
      }
    };
    
    // é¡µé¢åŠ è½½æ—¶è¿½è¸ªè®¿é—®
    visitTracker.trackVisit();
    
    // æ ‡ç­¾é¡µåˆ‡æ¢åŠŸèƒ½
    document.querySelectorAll('.tab-button').forEach(button => {
      button.addEventListener('click', function() {
        const tabId = this.getAttribute('data-tab');
        
        // ç§»é™¤æ‰€æœ‰æ´»åŠ¨çŠ¶æ€
        document.querySelectorAll('.tab-button').forEach(btn => {
          btn.classList.remove('active');
        });
        document.querySelectorAll('.map-container').forEach(container => {
          container.classList.remove('active');
        });
        
        // æ·»åŠ å½“å‰æ´»åŠ¨çŠ¶æ€
        this.classList.add('active');
        const targetContainer = document.getElementById(tabId);
        if (targetContainer) {
          targetContainer.classList.add('active');
          // åˆå§‹åŒ–åœ°å›¾ï¼ˆå¦‚æœå°šæœªåˆå§‹åŒ–ï¼‰
          initMap(tabId);
        }
      });
    });

    // æ·»åŠ æ°´å°åˆ°åœ°å›¾å®¹å™¨ï¼ˆç”¨äºå¯¼å‡ºæ—¶åŒ…å«æ°´å°ï¼‰
    function addWatermarkForExport(mapType, show = false) {
      const chartDiv = document.getElementById(`chartdiv-${mapType}`);
      if (!chartDiv) return;
      
      let watermark = chartDiv.querySelector('.map-watermark');
      if (!watermark) {
        watermark = document.createElement('div');
        watermark.className = 'map-watermark';
        watermark.innerHTML = 'å°çº¢ä¹¦@æ— èŠ±æœå…ˆç”Ÿ<br>https://figsama.github.io/2026qzdt/';
        watermark.style.cssText = 'position: absolute; bottom: 380px; left: 50px; font-size: 14px; color: #0f172a; opacity: 0.9; z-index: 9999; pointer-events: none; font-family: Inter, sans-serif; font-weight: 600; text-shadow: 0 1px 2px rgba(255, 255, 255, 0.8);';
        if (!show) {
          watermark.style.display = 'none';
        }
        chartDiv.appendChild(watermark);
      } else {
        watermark.style.display = show ? 'block' : 'none';
      }
    }

    // åˆå§‹åŒ–åœ°å›¾å‡½æ•°
    function initMap(mapType) {
      // è®¿é—®ç»Ÿè®¡åœ°å›¾æ¯æ¬¡éƒ½é‡æ–°åˆå§‹åŒ–ä»¥æ˜¾ç¤ºæœ€æ–°æ•°æ®
      if (maps[mapType] && mapType !== 'analytics') return; // å·²åˆå§‹åŒ–åˆ™è·³è¿‡

      switch(mapType) {
        case 'global':
          initGlobalMap();
          break;
        case 'china':
          initChinaMap();
          break;
        case 'us':
          initUSMap();
          break;
        case 'uk':
          initUKMap();
          break;
        case 'japan':
          initJapanMap();
          break;
        case 'australia':
          initAustraliaMap();
          break;
        case 'schengen':
          initSchengenMap();
          break;
        case 'analytics':
          initAnalyticsMap();
          break;
      }
    }

    // å…¨çƒæ±‡æ€»åœ°å›¾
    function initGlobalMap() {
      const defaultColors = {
        china: "#ef4444",
        issuer: "#3b82f6",
        major_issuer: "#3b82f6",
        conditional: "#14b8a6",
        transit: "#60a5fa",
        cn_free: "#10b981",
        cn_arrival: "#34d399",
        cn_evisa: "#a7f3d0",
        hmt_pass: "#ff9999",
        visa_required: "#cbd5e1"
      };
      
      // ä»localStorageåŠ è½½ä¿å­˜çš„é¢œè‰²
      const COLORS = {};
      const legendTitleToColorKey = {
        "ä¸­å›½å¤§é™†": "china",
        "ç­¾è¯ç­¾å‘å›½": "issuer",
        "æœ‰æ¡ä»¶å…ç­¾": "conditional",
        "æœ‰æ¡ä»¶è¿‡å¢ƒå…ç­¾": "transit",
        "ä¸­å›½æŠ¤ç…§å…ç­¾": "cn_free",
        "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾": "cn_arrival",
        "ä¸­å›½æŠ¤ç…§ç”µå­ç­¾": "cn_evisa",
        "éœ€åŠç†æ¸¯æ¾³å°é€šè¡Œè¯": "hmt_pass",
        "éœ€åŠç†ç­¾è¯": "visa_required"
      };
      
      for (const [key, value] of Object.entries(defaultColors)) {
        COLORS[key] = colorCustomizer.loadColor('global', key, value);
      }

      const countryData = {
        "CN": { title: "ä¸­å›½å¤§é™†", visas: ["ä¸­å›½å¤§é™†"], color: COLORS.china },
        "US": { title: "ç¾å›½", visas: ["ç¾ç­¾ç­¾å‘å›½"], color: "#3b82f6" },
        "GB": { title: "è‹±å›½", visas: ["è‹±ç­¾ç­¾å‘å›½"], color: "#3b82f6" },
        "JP": { title: "æ—¥æœ¬", visas: ["æ—¥ç­¾ç­¾å‘å›½"], color: "#3b82f6" },
        "AU": { title: "æ¾³å¤§åˆ©äºš", visas: ["æ¾³ç­¾ç­¾å‘å›½"], color: "#3b82f6" },
        "AT": { title: "å¥¥åœ°åˆ©", visas: ["ç”³æ ¹å›½"], color: COLORS.issuer },
        "BE": { title: "æ¯”åˆ©æ—¶", visas: ["ç”³æ ¹å›½"], color: COLORS.issuer },
        "CZ": { title: "æ·å…‹", visas: ["ç”³æ ¹å›½"], color: COLORS.issuer },
        "DK": { title: "ä¸¹éº¦", visas: ["ç”³æ ¹å›½"], color: COLORS.issuer },
        "EE": { title: "çˆ±æ²™å°¼äºš", visas: ["ç”³æ ¹å›½"], color: COLORS.issuer },
        "FI": { title: "èŠ¬å…°", visas: ["ç”³æ ¹å›½"], color: COLORS.issuer },
        "FR": { title: "æ³•å›½", visas: ["ç”³æ ¹å›½"], color: COLORS.issuer },
        "DE": { title: "å¾·å›½", visas: ["ç”³æ ¹å›½"], color: COLORS.issuer },
        "GR": { title: "å¸Œè…Š", visas: ["ç”³æ ¹å›½"], color: COLORS.issuer },
        "HU": { title: "åŒˆç‰™åˆ©", visas: ["ç”³æ ¹å›½"], color: COLORS.issuer },
        "IS": { title: "å†°å²›", visas: ["ç”³æ ¹å›½"], color: COLORS.issuer },
        "IT": { title: "æ„å¤§åˆ©", visas: ["ç”³æ ¹å›½"], color: COLORS.issuer },
        "LV": { title: "æ‹‰è„±ç»´äºš", visas: ["ç”³æ ¹å›½"], color: COLORS.issuer },
        "LI": { title: "åˆ—æ”¯æ•¦å£«ç™»", visas: ["ç”³æ ¹å›½"], color: COLORS.issuer },
        "LT": { title: "ç«‹é™¶å®›", visas: ["ç”³æ ¹å›½"], color: COLORS.issuer },
        "LU": { title: "å¢æ£®å ¡", visas: ["ç”³æ ¹å›½"], color: COLORS.issuer },
        "MT": { title: "é©¬è€³ä»–", visas: ["ç”³æ ¹å›½"], color: COLORS.issuer },
        "NL": { title: "è·å…°", visas: ["ç”³æ ¹å›½"], color: COLORS.issuer },
        "NO": { title: "æŒªå¨", visas: ["ç”³æ ¹å›½"], color: COLORS.issuer },
        "PL": { title: "æ³¢å…°", visas: ["ç”³æ ¹å›½"], color: COLORS.issuer },
        "PT": { title: "è‘¡è„ç‰™", visas: ["ç”³æ ¹å›½"], color: COLORS.issuer },
        "SK": { title: "æ–¯æ´›ä¼å…‹", visas: ["ç”³æ ¹å›½"], color: COLORS.issuer },
        "SI": { title: "æ–¯æ´›æ–‡å°¼äºš", visas: ["ç”³æ ¹å›½"], color: COLORS.issuer },
        "ES": { title: "è¥¿ç­ç‰™", visas: ["ç”³æ ¹å›½"], color: COLORS.issuer },
        "SE": { title: "ç‘å…¸", visas: ["ç”³æ ¹å›½"], color: COLORS.issuer },
        "CH": { title: "ç‘å£«", visas: ["ç”³æ ¹å›½"], color: COLORS.issuer },
        "BG": { title: "ä¿åŠ åˆ©äºš", visas: ["ç”³æ ¹å›½"], color: COLORS.issuer },
        "RO": { title: "ç½—é©¬å°¼äºš", visas: ["ç”³æ ¹å›½"], color: COLORS.issuer },
        "HR": { title: "å…‹ç½—åœ°äºš", visas: ["ç”³æ ¹å›½"], color: COLORS.issuer },
        "MX": { title: "å¢¨è¥¿å“¥", visas: ["ç¾ç­¾180å¤©", "ç”³æ ¹ç­¾180å¤©", "å¤šæ¬¡æ—¥ç­¾", "è‹±ç­¾180å¤©"], color: COLORS.conditional },
        "PE": { title: "ç§˜é²", visas: ["ç¾ç­¾180å¤©", "ç”³æ ¹ç­¾180å¤©", "è‹±ç­¾180å¤©", "æ¾³ç­¾180å¤©"], color: COLORS.conditional },
        "CO": { title: "å“¥ä¼¦æ¯”äºš", visas: ["ç¾ç­¾90å¤©", "ç”³æ ¹ç­¾90å¤©"], color: COLORS.conditional },
        "BM": { title: "ç™¾æ…•å¤§", visas: ["ç¾ç­¾90å¤©", "è‹±ç­¾180å¤©"], color: COLORS.conditional },
        "MD": { title: "æ‘©å°”å¤šç“¦", visas: ["ç¾ç­¾90å¤©", "ç”³æ ¹ç­¾å…ç­¾", "è‹±ç­¾å…ç­¾"], color: COLORS.conditional },
        "UY": { title: "ä¹Œæ‹‰åœ­", visas: ["ç¾ç­¾90å¤©", "ç”³æ ¹ç­¾90å¤©"], color: COLORS.conditional },
        "DO": { title: "å¤šç±³å°¼åŠ ", visas: ["ç¾ç­¾30å¤©", "ç”³æ ¹ç­¾30å¤©", "è‹±ç­¾30å¤©"], color: COLORS.conditional },
        "CR": { title: "å“¥æ–¯è¾¾é»åŠ ", visas: ["ç¾ç­¾30å¤©", "ç”³æ ¹ç­¾30å¤©(éœ€Dç±»)", "è‹±ç­¾30å¤©"], color: COLORS.conditional },
        "PA": { title: "å·´æ‹¿é©¬", visas: ["ç¾ç­¾30å¤©", "ç”³æ ¹ç­¾30å¤©", "å¤šæ¬¡æ—¥ç­¾", "è‹±ç­¾30å¤©", "æ¾³ç­¾(éœ€å·²ä½¿ç”¨1æ¬¡)"], color: COLORS.conditional },
        "HN": { title: "æ´ªéƒ½æ‹‰æ–¯", visas: ["ç¾ç­¾30å¤©", "ç”³æ ¹ç­¾90å¤©"], color: COLORS.conditional },
        "KY": { title: "å¼€æ›¼ç¾¤å²›", visas: ["ç¾ç­¾30å¤©", "è‹±ç­¾å…ç­¾"], color: COLORS.conditional },
        "MK": { title: "åŒ—é©¬å…¶é¡¿", visas: ["ç¾ç­¾15å¤©", "è‹±ç­¾(6ä¸ªæœˆå†…ä¸è¶…è¿‡90å¤©)"], color: COLORS.conditional },
        "PH": { title: "è²å¾‹å®¾", visas: ["ç¾ç­¾7å¤©", "ç”³æ ¹ç­¾7å¤©", "å•æ¬¡æˆ–å¤šæ¬¡æ—¥ç­¾", "æ¾³ç­¾7å¤©"], color: COLORS.conditional },
        "ME": { title: "é»‘å±±", visas: ["ç¾ç­¾30å¤©", "ç”³æ ¹ç­¾30å¤©", "å¤šæ¬¡æ—¥ç­¾", "è‹±ç­¾7å¤©"], color: COLORS.conditional },
        "AL": { title: "é˜¿å°”å·´å°¼äºš", visas: ["ä¸­å›½æŠ¤ç…§å…ç­¾"], color: COLORS.cn_free },
        "CW": { title: "åº“æ‹‰ç´¢", visas: ["ç¾ç­¾90å¤©", "ç”³æ ¹ç­¾(éœ€å¤šæ¬¡å…¥å¢ƒ)"], color: COLORS.conditional },
        "AW": { title: "é˜¿é²å·´", visas: ["ç¾ç­¾90å¤©", "ç”³æ ¹ç­¾(éœ€å¤šæ¬¡å…¥å¢ƒ)"], color: COLORS.conditional },
        "SX": { title: "è·å±åœ£é©¬ä¸", visas: ["ç¾ç­¾90å¤©", "ç”³æ ¹ç­¾(éœ€å¤šæ¬¡å…¥å¢ƒ)"], color: COLORS.conditional },
        "BQ": { title: "è·å±åŠ å‹’æ¯”", visas: ["ç¾ç­¾90å¤©", "ç”³æ ¹ç­¾(éœ€å¤šæ¬¡å…¥å¢ƒ)"], color: COLORS.conditional },
        "CL": { title: "æ™ºåˆ©", visas: ["ç¾ç­¾90å¤©"], color: COLORS.conditional },
        "AR": { title: "é˜¿æ ¹å»·", visas: ["ç¾ç­¾30å¤©"], color: COLORS.conditional },
        "BZ": { title: "ä¼¯åˆ©å…¹", visas: ["ç¾ç­¾30å¤©"], color: COLORS.conditional },
        "ST": { title: "åœ£å¤šç¾å’Œæ™®æ—è¥¿æ¯”", visas: ["ç¾ç­¾15å¤©", "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾"], color: COLORS.conditional },
        "SV": { title: "è¨å°”ç“¦å¤š", visas: ["ç”³æ ¹ç­¾90å¤©(æ”¶è´¹12ç¾å…ƒ)"], color: COLORS.conditional },
        "RS": { title: "å¡å°”ç»´äºš", visas: ["ä¸­å›½æŠ¤ç…§å…ç­¾"], color: COLORS.cn_free },
        "BA": { title: "æ³¢é»‘", visas: ["ä¸­å›½æŠ¤ç…§å…ç­¾"], color: COLORS.cn_free },
        "XK": { title: "ç§‘ç´¢æ²ƒ", visas: ["ç”³æ ¹ç­¾å…ç­¾(éœ€å¤šæ¬¡)"], color: COLORS.conditional },
        "HK": { title: "ä¸­å›½é¦™æ¸¯", visas: ["éœ€åŠç†æ¸¯æ¾³å°é€šè¡Œè¯"], color: COLORS.hmt_pass },
        "MO": { title: "ä¸­å›½æ¾³é—¨", visas: ["éœ€åŠç†æ¸¯æ¾³å°é€šè¡Œè¯"], color: COLORS.hmt_pass },
        "TW": { title: "ä¸­å›½å°æ¹¾", visas: ["éœ€åŠç†æ¸¯æ¾³å°é€šè¡Œè¯"], color: COLORS.hmt_pass },
        "CY": { title: "å¡æµ¦è·¯æ–¯", visas: ["ç”³æ ¹ç­¾(éœ€æœ‰æ•ˆç­¾è¯)"], color: COLORS.conditional },
        "IE": { title: "çˆ±å°”å…°", visas: ["è‹±ç­¾(å·²ä½¿ç”¨)"], color: COLORS.conditional },
        "GI": { title: "ç›´å¸ƒç½—é™€", visas: ["è‹±ç­¾(1å¹´ä»¥ä¸Š)"], color: COLORS.conditional },
        "JE": { title: "æ³½è¥¿å²›", visas: ["è‹±ç­¾(æœ‰æ•ˆ)"], color: COLORS.conditional },
        "GG": { title: "æ ¹è¥¿å²›", visas: ["è‹±ç­¾(æœ‰æ•ˆ)"], color: COLORS.conditional },
        "IM": { title: "é©¬æ©å²›", visas: ["è‹±ç­¾(æœ‰æ•ˆ)"], color: COLORS.conditional },
        "AI": { title: "å®‰åœ­æ‹‰", visas: ["è‹±ç­¾(æœ‰æ•ˆ)"], color: COLORS.conditional },
        "FJ": { title: "æ–æµ", visas: ["è‹±ç­¾4ä¸ªæœˆ(éœ€6ä¸ªæœˆæœ‰æ•ˆæœŸ)", "ä¸­å›½æŠ¤ç…§å…ç­¾"], color: COLORS.conditional },
        "NZ": { title: "æ–°è¥¿å…°", visas: ["æ¾³ç­¾(éœ€å…ˆä»æ¾³æ´²å…¥å¢ƒï¼Œç”³è¯·NZeTA)"], color: COLORS.conditional },
        "KR": { title: "éŸ©å›½", visas: ["ç¾ç­¾è¿‡å¢ƒ30å¤©", "ç”³æ ¹ç­¾è¿‡å¢ƒ30å¤©", "è‹±ç­¾è¿‡å¢ƒ30å¤©", "æ¾³ç­¾è¿‡å¢ƒ30å¤©", "ä¸­å›½æŠ¤ç…§å…ç­¾(æµå·å²›)"], color: COLORS.transit },
        "JP": { title: "æ—¥æœ¬", visas: ["ç¾ç­¾è¿‡å¢ƒ72å°æ—¶", "æ¾³ç­¾è¿‡å¢ƒ72å°æ—¶"], color: COLORS.transit },
        "GB": { title: "è‹±å›½", visas: ["ç¾ç­¾è¿‡å¢ƒ24å°æ—¶"], color: COLORS.transit },
        "SG": { title: "æ–°åŠ å¡", visas: ["ä¸­å›½æŠ¤ç…§å…ç­¾"], color: COLORS.cn_free },
        "RU": { title: "ä¿„ç½—æ–¯", visas: ["ä¸­å›½æŠ¤ç…§å…ç­¾"], color: COLORS.cn_free },
        "KH": { title: "æŸ¬åŸ”å¯¨", visas: ["ä¸­å›½æŠ¤ç…§å…ç­¾"], color: COLORS.cn_free },
        "TR": { title: "åœŸè€³å…¶", visas: ["ä¸­å›½æŠ¤ç…§å…ç­¾"], color: COLORS.cn_free },
        "BR": { title: "å·´è¥¿", visas: ["ä¸­å›½æŠ¤ç…§å…ç­¾"], color: COLORS.cn_free },
        "AE": { title: "é˜¿è”é…‹", visas: ["ä¸­å›½æŠ¤ç…§å…ç­¾"], color: COLORS.cn_free },
        "BB": { title: "å·´å·´å¤šæ–¯", visas: ["ä¸­å›½æŠ¤ç…§å…ç­¾"], color: COLORS.cn_free },
        "BS": { title: "å·´å“ˆé©¬", visas: ["ä¸­å›½æŠ¤ç…§å…ç­¾"], color: COLORS.cn_free },
        "GD": { title: "æ ¼æ—çº³è¾¾", visas: ["ä¸­å›½æŠ¤ç…§å…ç­¾"], color: COLORS.cn_free },
        "MU": { title: "æ¯›é‡Œæ±‚æ–¯", visas: ["ä¸­å›½æŠ¤ç…§å…ç­¾"], color: COLORS.cn_free },
        "SM": { title: "åœ£é©¬åŠ›è¯º", visas: ["ä¸­å›½æŠ¤ç…§å…ç­¾"], color: COLORS.cn_free },
        "SC": { title: "å¡èˆŒå°”", visas: ["ä¸­å›½æŠ¤ç…§å…ç­¾"], color: COLORS.cn_free },
        "TO": { title: "æ±¤åŠ ", visas: ["ä¸­å›½æŠ¤ç…§å…ç­¾"], color: COLORS.cn_free },
        "BY": { title: "ç™½ä¿„ç½—æ–¯", visas: ["ä¸­å›½æŠ¤ç…§å…ç­¾"], color: COLORS.cn_free },
        "QA": { title: "å¡å¡”å°”", visas: ["ä¸­å›½æŠ¤ç…§å…ç­¾"], color: COLORS.cn_free },
        "AM": { title: "äºšç¾å°¼äºš", visas: ["ä¸­å›½æŠ¤ç…§å…ç­¾"], color: COLORS.cn_free },
        "UZ": { title: "ä¹Œå…¹åˆ«å…‹æ–¯å¦", visas: ["ä¸­å›½æŠ¤ç…§å…ç­¾"], color: COLORS.cn_free },
        "OM": { title: "é˜¿æ›¼", visas: ["ä¸­å›½æŠ¤ç…§å…ç­¾"], color: COLORS.cn_free },
        "MA": { title: "æ‘©æ´›å“¥", visas: ["ä¸­å›½æŠ¤ç…§å…ç­¾"], color: COLORS.cn_free },
        "RE": { title: "æ³•å±ç•™å°¼æ±ª", visas: ["ä¸­å›½æŠ¤ç…§å…ç­¾"], color: COLORS.cn_free },
        "TN": { title: "çªå°¼æ–¯", visas: ["ä¸­å›½æŠ¤ç…§å…ç­¾"], color: COLORS.cn_free },
        "AG": { title: "å®‰æç“œå’Œå·´å¸ƒè¾¾", visas: ["ä¸­å›½æŠ¤ç…§å…ç­¾"], color: COLORS.cn_free },
        "HT": { title: "æµ·åœ°", visas: ["ä¸­å›½æŠ¤ç…§å…ç­¾"], color: COLORS.cn_free },
        "GS": { title: "å—ä¹”æ²»äºšå’Œå—æ¡‘å¨å¥‡ç¾¤å²›", visas: ["ä¸­å›½æŠ¤ç…§å…ç­¾"], color: COLORS.cn_free },
        "KN": { title: "åœ£åŸºèŒ¨å’Œå°¼ç»´æ–¯", visas: ["ä¸­å›½æŠ¤ç…§å…ç­¾"], color: COLORS.cn_free },
        "TC": { title: "ç‰¹å…‹æ–¯å’Œå‡¯ç§‘æ–¯ç¾¤å²›", visas: ["ä¸­å›½æŠ¤ç…§å…ç­¾"], color: COLORS.cn_free },
        "JM": { title: "ç‰™ä¹°åŠ ", visas: ["ä¸­å›½æŠ¤ç…§å…ç­¾"], color: COLORS.cn_free },
        "DM": { title: "å¤šç±³å°¼å…‹", visas: ["ä¸­å›½æŠ¤ç…§å…ç­¾"], color: COLORS.cn_free },
        "MP": { title: "å¡ç­å²›", visas: ["ä¸­å›½æŠ¤ç…§å…ç­¾"], color: COLORS.cn_free },
        "WS": { title: "è¨æ‘©äºš", visas: ["ä¸­å›½æŠ¤ç…§å…ç­¾"], color: COLORS.cn_free },
        "PF": { title: "æ³•å±æ³¢åˆ©å°¼è¥¿äºš", visas: ["ä¸­å›½æŠ¤ç…§å…ç­¾"], color: COLORS.cn_free },
        "LC": { title: "åœ£å¢è¥¿äºš", visas: ["ä¸­å›½æŠ¤ç…§å…ç­¾"], color: COLORS.cn_free },
        "CK": { title: "åº“å…‹ç¾¤å²›", visas: ["ä¸­å›½æŠ¤ç…§å…ç­¾"], color: COLORS.cn_free },
        "NU": { title: "çº½åŸƒ", visas: ["ä¸­å›½æŠ¤ç…§å…ç­¾"], color: COLORS.cn_free },
        "IR": { title: "ä¼Šæœ—", visas: ["ä¸­å›½æŠ¤ç…§å…ç­¾"], color: COLORS.cn_free },
        "ZM": { title: "èµæ¯”äºš", visas: ["ä¸­å›½æŠ¤ç…§å…ç­¾"], color: COLORS.cn_free },
        "SR": { title: "è‹é‡Œå—", visas: ["ä¸­å›½æŠ¤ç…§å…ç­¾"], color: COLORS.cn_free },
        "MV": { title: "é©¬å°”ä»£å¤«", visas: ["ä¸­å›½æŠ¤ç…§å…ç­¾"], color: COLORS.cn_free },
        "KZ": { title: "å“ˆè¨å…‹æ–¯å¦", visas: ["ä¸­å›½æŠ¤ç…§å…ç­¾"], color: COLORS.cn_free },
        "GA": { title: "åŠ è“¬", visas: ["ä¸­å›½æŠ¤ç…§å…ç­¾"], color: COLORS.cn_free },
        "MZ": { title: "è«æ¡‘æ¯”å…‹", visas: ["ä¸­å›½æŠ¤ç…§å…ç­¾"], color: COLORS.cn_free },
        "BJ": { title: "è´å®", visas: ["ä¸­å›½æŠ¤ç…§å…ç­¾"], color: COLORS.cn_free },
        "AO": { title: "å®‰å“¥æ‹‰", visas: ["ä¸­å›½æŠ¤ç…§å…ç­¾"], color: COLORS.cn_free },
        "GE": { title: "æ ¼é²å‰äºš", visas: ["ä¸­å›½æŠ¤ç…§å…ç­¾"], color: COLORS.cn_free },
        "PS": { title: "å·´å‹’æ–¯å¦", visas: ["ä¸­å›½æŠ¤ç…§å…ç­¾"], color: COLORS.cn_free },
        "TH": { title: "æ³°å›½", visas: ["ä¸­å›½æŠ¤ç…§å…ç­¾"], color: COLORS.cn_free },
        "MY": { title: "é©¬æ¥è¥¿äºš", visas: ["ä¸­å›½æŠ¤ç…§å…ç­¾"], color: COLORS.cn_free },
        "LK": { title: "æ–¯é‡Œå…°å¡", visas: ["ä¸­å›½æŠ¤ç…§å…ç­¾"], color: COLORS.cn_free },
        "CU": { title: "å¤å·´", visas: ["ä¸­å›½æŠ¤ç…§å…ç­¾"], color: COLORS.cn_free },
        "AZ": { title: "é˜¿å¡æ‹œç–†", visas: ["ä¸­å›½æŠ¤ç…§å…ç­¾"], color: COLORS.cn_free },
        "PK": { title: "å·´åŸºæ–¯å¦", visas: ["ä¸­å›½æŠ¤ç…§å…ç­¾"], color: COLORS.cn_free },
        "VU": { title: "ç“¦åŠªé˜¿å›¾", visas: ["ä¸­å›½æŠ¤ç…§å…ç­¾"], color: COLORS.cn_free },
        "SB": { title: "æ‰€ç½—é—¨ç¾¤å²›", visas: ["ä¸­å›½æŠ¤ç…§å…ç­¾"], color: COLORS.cn_free },
        "SJ": { title: "æ–¯ç“¦å°”å·´ç¾¤å²›", visas: ["ä¸­å›½æŠ¤ç…§å…ç­¾"], color: COLORS.cn_free },
        "AX": { title: "å¥¥å…°ç¾¤å²›", visas: ["ä¸­å›½æŠ¤ç…§å…ç­¾"], color: COLORS.cn_free },
        "BN": { title: "æ–‡è±", visas: ["ä¸­å›½æŠ¤ç…§è½åœ°ç­¾"], color: COLORS.cn_arrival },
        "TL": { title: "ä¸œå¸æ±¶", visas: ["ä¸­å›½æŠ¤ç…§è½åœ°ç­¾"], color: COLORS.cn_arrival },
        "LA": { title: "è€æŒ", visas: ["ä¸­å›½æŠ¤ç…§è½åœ°ç­¾"], color: COLORS.cn_arrival },
        "LB": { title: "é»å·´å«©", visas: ["ä¸­å›½æŠ¤ç…§è½åœ°ç­¾"], color: COLORS.cn_arrival },
        "MM": { title: "ç¼…ç”¸", visas: ["ä¸­å›½æŠ¤ç…§è½åœ°ç­¾"], color: COLORS.cn_arrival },
        "NP": { title: "å°¼æ³Šå°”", visas: ["ä¸­å›½æŠ¤ç…§è½åœ°ç­¾"], color: COLORS.cn_arrival },
        "JO": { title: "çº¦æ—¦", visas: ["ä¸­å›½æŠ¤ç…§è½åœ°ç­¾"], color: COLORS.cn_arrival },
        "BD": { title: "å­ŸåŠ æ‹‰å›½", visas: ["ä¸­å›½æŠ¤ç…§è½åœ°ç­¾"], color: COLORS.cn_arrival },
        "EG": { title: "åŸƒåŠ", visas: ["ä¸­å›½æŠ¤ç…§è½åœ°ç­¾"], color: COLORS.cn_arrival },
        "TG": { title: "å¤šå“¥", visas: ["ä¸­å›½æŠ¤ç…§è½åœ°ç­¾"], color: COLORS.cn_arrival },
        "CV": { title: "ä½›å¾—è§’", visas: ["ä¸­å›½æŠ¤ç…§è½åœ°ç­¾"], color: COLORS.cn_arrival },
        "KM": { title: "ç§‘æ‘©ç½—", visas: ["ä¸­å›½æŠ¤ç…§è½åœ°ç­¾"], color: COLORS.cn_arrival },
        "RW": { title: "å¢æ—ºè¾¾", visas: ["ä¸­å›½æŠ¤ç…§è½åœ°ç­¾"], color: COLORS.cn_arrival },
        "MG": { title: "é©¬è¾¾åŠ æ–¯åŠ ", visas: ["ä¸­å›½æŠ¤ç…§è½åœ°ç­¾"], color: COLORS.cn_arrival },
        "MW": { title: "é©¬æ‹‰ç»´", visas: ["ä¸­å›½æŠ¤ç…§è½åœ°ç­¾"], color: COLORS.cn_arrival },
        "MR": { title: "æ¯›é‡Œå¡”å°¼äºš", visas: ["ä¸­å›½æŠ¤ç…§è½åœ°ç­¾"], color: COLORS.cn_arrival },
        "TZ": { title: "å¦æ¡‘å°¼äºš", visas: ["ä¸­å›½æŠ¤ç…§è½åœ°ç­¾"], color: COLORS.cn_arrival },
        "UG": { title: "ä¹Œå¹²è¾¾", visas: ["ä¸­å›½æŠ¤ç…§è½åœ°ç­¾"], color: COLORS.cn_arrival },
        "ZW": { title: "æ´¥å·´å¸ƒéŸ¦", visas: ["ä¸­å›½æŠ¤ç…§è½åœ°ç­¾"], color: COLORS.cn_arrival },
        "SH": { title: "åœ£èµ«å‹’æ‹¿", visas: ["ä¸­å›½æŠ¤ç…§è½åœ°ç­¾"], color: COLORS.cn_arrival },
        "PW": { title: "å¸•åŠ³", visas: ["ä¸­å›½æŠ¤ç…§è½åœ°ç­¾"], color: COLORS.cn_arrival },
        "TV": { title: "å›¾ç“¦å¢", visas: ["ä¸­å›½æŠ¤ç…§è½åœ°ç­¾"], color: COLORS.cn_arrival },
        "PG": { title: "å·´å¸ƒäºšæ–°å‡ å†…äºš", visas: ["ä¸­å›½æŠ¤ç…§è½åœ°ç­¾"], color: COLORS.cn_arrival },
        "SA": { title: "æ²™ç‰¹é˜¿æ‹‰ä¼¯", visas: ["ä¸­å›½æŠ¤ç…§è½åœ°ç­¾"], color: COLORS.cn_arrival },
        "KE": { title: "è‚¯å°¼äºš", visas: ["ä¸­å›½æŠ¤ç…§è½åœ°ç­¾"], color: COLORS.cn_arrival },
        "GW": { title: "å‡ å†…äºšæ¯”ç»", visas: ["ä¸­å›½æŠ¤ç…§è½åœ°ç­¾"], color: COLORS.cn_arrival },
        "SL": { title: "å¡æ‹‰åˆ©æ˜‚", visas: ["ä¸­å›½æŠ¤ç…§è½åœ°ç­¾"], color: COLORS.cn_arrival },
        "ET": { title: "åŸƒå¡ä¿„æ¯”äºš", visas: ["ä¸­å›½æŠ¤ç…§è½åœ°ç­¾"], color: COLORS.cn_arrival },
        "DJ": { title: "å‰å¸ƒæ", visas: ["ä¸­å›½æŠ¤ç…§è½åœ°ç­¾"], color: COLORS.cn_arrival },
        "SO": { title: "ç´¢é©¬é‡Œ", visas: ["ä¸­å›½æŠ¤ç…§è½åœ°ç­¾"], color: COLORS.cn_arrival },
        "BO": { title: "ç»åˆ©ç»´äºš", visas: ["ä¸­å›½æŠ¤ç…§è½åœ°ç­¾"], color: COLORS.cn_arrival },
        "ID": { title: "å°åº¦å°¼è¥¿äºš", visas: ["ä¸­å›½æŠ¤ç…§è½åœ°ç­¾"], color: COLORS.cn_arrival },
        "IQ": { title: "ä¼Šæ‹‰å…‹", visas: ["ä¸­å›½æŠ¤ç…§ç”µå­ç­¾"], color: COLORS.cn_evisa },
        "SN": { title: "å¡å†…åŠ å°”", visas: ["ä¸­å›½æŠ¤ç…§è½åœ°ç­¾"], color: COLORS.cn_arrival },
        "BI": { title: "å¸ƒéš†è¿ª", visas: ["ä¸­å›½æŠ¤ç…§è½åœ°ç­¾"], color: COLORS.cn_arrival },
        "NR": { title: "ç‘™é²", visas: ["ä¸­å›½æŠ¤ç…§è½åœ°ç­¾"], color: COLORS.cn_arrival },
        "KG": { title: "å‰å°”å‰æ–¯æ–¯å¦", visas: ["ä¸­å›½æŠ¤ç…§ç”µå­ç­¾"], color: COLORS.cn_evisa },
        "TJ": { title: "å¡”å‰å…‹æ–¯å¦", visas: ["ä¸­å›½æŠ¤ç…§ç”µå­ç­¾"], color: COLORS.cn_evisa },
        "BH": { title: "å·´æ—", visas: ["ä¸­å›½æŠ¤ç…§ç”µå­ç­¾"], color: COLORS.cn_evisa },
        "GN": { title: "å‡ å†…äºš", visas: ["ä¸­å›½æŠ¤ç…§ç”µå­ç­¾"], color: COLORS.cn_evisa },
        "LS": { title: "è±ç´¢æ‰˜", visas: ["ä¸­å›½æŠ¤ç…§ç”µå­ç­¾"], color: COLORS.cn_evisa },
        "MS": { title: "è’™ç‰¹å¡æ‹‰ç‰¹", visas: ["ä¸­å›½æŠ¤ç…§ç”µå­ç­¾"], color: COLORS.cn_evisa },
        "VN": { title: "è¶Šå—", visas: ["ä¸­å›½æŠ¤ç…§ç”µå­ç­¾"], color: COLORS.cn_evisa },
        "MN": { title: "è’™å¤", visas: ["ä¸­å›½æŠ¤ç…§ç”µå­ç­¾"], color: COLORS.cn_evisa },
        "SS": { title: "å—è‹ä¸¹", visas: ["ä¸­å›½æŠ¤ç…§ç”µå­ç­¾"], color: COLORS.cn_evisa },
        "CD": { title: "åˆšæœ(é‡‘)", visas: ["ä¸­å›½æŠ¤ç…§ç”µå­ç­¾"], color: COLORS.cn_evisa },
        "NG": { title: "å°¼æ—¥åˆ©äºš", visas: ["ä¸­å›½æŠ¤ç…§ç”µå­ç­¾"], color: COLORS.cn_evisa },
        "GQ": { title: "èµ¤é“å‡ å†…äºš", visas: ["ä¸­å›½æŠ¤ç…§ç”µå­ç­¾"], color: COLORS.cn_evisa },
        "CI": { title: "ç§‘ç‰¹è¿ªç“¦", visas: ["ä¸­å›½æŠ¤ç…§ç”µå­ç­¾"], color: COLORS.cn_evisa },
        "CM": { title: "å–€éº¦éš†", visas: ["ä¸­å›½æŠ¤ç…§ç”µå­ç­¾"], color: COLORS.cn_evisa },
        "BT": { title: "ä¸ä¸¹", visas: ["ä¸­å›½æŠ¤ç…§ç”µå­ç­¾"], color: COLORS.cn_evisa },
        "BW": { title: "åšèŒ¨ç“¦çº³", visas: ["ä¸­å›½æŠ¤ç…§ç”µå­ç­¾"], color: COLORS.cn_evisa },
        "UA": { title: "ä¹Œå…‹å…°", visas: ["ä¸­å›½æŠ¤ç…§ç”µå­ç­¾"], color: COLORS.cn_evisa },
        "ZA": { title: "å—é", visas: ["ä¸­å›½æŠ¤ç…§ç”µå­ç­¾"], color: COLORS.cn_evisa },
        "CA": { title: "åŠ æ‹¿å¤§", visas: ["éœ€åŠç†ç­¾è¯"], color: COLORS.visa_required },
        "IN": { title: "å°åº¦", visas: ["éœ€åŠç†ç­¾è¯"], color: COLORS.visa_required },
        "IL": { title: "ä»¥è‰²åˆ—", visas: ["éœ€åŠç†ç­¾è¯"], color: COLORS.visa_required },
        "AF": { title: "é˜¿å¯Œæ±—", visas: ["éœ€åŠç†ç­¾è¯"], color: COLORS.visa_required },
        "DZ": { title: "é˜¿å°”åŠåˆ©äºš", visas: ["éœ€åŠç†ç­¾è¯"], color: COLORS.visa_required },
        "AD": { title: "å®‰é“å°”", visas: ["éœ€åŠç†ç­¾è¯"], color: COLORS.visa_required },
        "BF": { title: "å¸ƒåŸºçº³æ³•ç´¢", visas: ["éœ€åŠç†ç­¾è¯"], color: COLORS.visa_required },
        "CF": { title: "ä¸­é", visas: ["éœ€åŠç†ç­¾è¯"], color: COLORS.visa_required },
        "TD": { title: "ä¹å¾—", visas: ["éœ€åŠç†ç­¾è¯"], color: COLORS.visa_required },
        "CG": { title: "åˆšæœ", visas: ["éœ€åŠç†ç­¾è¯"], color: COLORS.visa_required },
        "EC": { title: "å„ç“œå¤šå°”", visas: ["éœ€åŠç†ç­¾è¯"], color: COLORS.visa_required },
        "ER": { title: "å„ç«‹ç‰¹é‡Œäºš", visas: ["éœ€åŠç†ç­¾è¯"], color: COLORS.visa_required },
        "SZ": { title: "æ–¯å¨å£«å…°", visas: ["éœ€åŠç†ç­¾è¯"], color: COLORS.visa_required },
        "GM": { title: "å†ˆæ¯”äºš", visas: ["éœ€åŠç†ç­¾è¯"], color: COLORS.visa_required },
        "GT": { title: "å±åœ°é©¬æ‹‰", visas: ["éœ€åŠç†ç­¾è¯"], color: COLORS.visa_required },
        "GY": { title: "åœ­äºšé‚£", visas: ["éœ€åŠç†ç­¾è¯"], color: COLORS.visa_required },
        "KI": { title: "åŸºé‡Œå·´æ–¯", visas: ["éœ€åŠç†ç­¾è¯"], color: COLORS.visa_required },
        "KP": { title: "æœé²œ", visas: ["éœ€åŠç†ç­¾è¯"], color: COLORS.visa_required },
        "KW": { title: "ç§‘å¨ç‰¹", visas: ["éœ€åŠç†ç­¾è¯"], color: COLORS.visa_required },
        "LR": { title: "åˆ©æ¯”é‡Œäºš", visas: ["éœ€åŠç†ç­¾è¯"], color: COLORS.visa_required },
        "LY": { title: "åˆ©æ¯”äºš", visas: ["éœ€åŠç†ç­¾è¯"], color: COLORS.visa_required },
        "ML": { title: "é©¬é‡Œ", visas: ["éœ€åŠç†ç­¾è¯"], color: COLORS.visa_required },
        "MH": { title: "é©¬ç»å°”ç¾¤å²›", visas: ["éœ€åŠç†ç­¾è¯"], color: COLORS.visa_required },
        "MC": { title: "æ‘©çº³å“¥", visas: ["éœ€åŠç†ç­¾è¯"], color: COLORS.visa_required },
        "NA": { title: "çº³ç±³æ¯”äºš", visas: ["éœ€åŠç†ç­¾è¯"], color: COLORS.visa_required },
        "NI": { title: "å°¼åŠ æ‹‰ç“œ", visas: ["éœ€åŠç†ç­¾è¯"], color: COLORS.visa_required },
        "NE": { title: "å°¼æ—¥å°”", visas: ["éœ€åŠç†ç­¾è¯"], color: COLORS.visa_required },
        "PY": { title: "å·´æ‹‰åœ­", visas: ["éœ€åŠç†ç­¾è¯"], color: COLORS.visa_required },
        "VC": { title: "åœ£æ–‡æ£®ç‰¹å’Œæ ¼æ—çº³ä¸æ–¯", visas: ["éœ€åŠç†ç­¾è¯"], color: COLORS.visa_required },
        "SD": { title: "è‹ä¸¹", visas: ["éœ€åŠç†ç­¾è¯"], color: COLORS.visa_required },
        "SY": { title: "å™åˆ©äºš", visas: ["éœ€åŠç†ç­¾è¯"], color: COLORS.visa_required },
        "TM": { title: "åœŸåº“æ›¼æ–¯å¦", visas: ["éœ€åŠç†ç­¾è¯"], color: COLORS.visa_required },
        "TT": { title: "ç‰¹ç«‹å°¼è¾¾å’Œå¤šå·´å“¥", visas: ["éœ€åŠç†ç­¾è¯"], color: COLORS.visa_required },
        "VA": { title: "æ¢µè’‚å†ˆ", visas: ["éœ€åŠç†ç­¾è¯"], color: COLORS.visa_required },
        "VE": { title: "å§”å†…ç‘æ‹‰", visas: ["éœ€åŠç†ç­¾è¯"], color: COLORS.visa_required },
        "YE": { title: "ä¹Ÿé—¨", visas: ["éœ€åŠç†ç­¾è¯"], color: COLORS.visa_required },
        "GL": { title: "æ ¼é™µå…°å²›", visas: ["éœ€åŠç†ç­¾è¯"], color: COLORS.visa_required },
        "FO": { title: "æ³•ç½—ç¾¤å²›", visas: ["éœ€åŠç†ç­¾è¯"], color: COLORS.visa_required }
      };

      const areas = Object.keys(countryData).map(id => {
        const data = countryData[id];
        const visaText = data.visas.length > 1 
          ? `æœ‰æ¡ä»¶å…ç­¾<br/>å¯æŒ: ${data.visas.join(" / ")}`
          : data.visas[0];
        return { id: id, title: data.title, customData: visaText, color: data.color };
      });

      maps['global'] = AmCharts.makeChart("chartdiv-global", {
        "type": "map", "theme": "light", "projection": "miller",
        "dataProvider": { "map": "worldHigh", "zoomLevel": 1.2, "zoomLongitude": 20, "zoomLatitude": 30, "areas": areas },
        "areasSettings": { "autoZoom": true, "rollOverOutlineColor": "#FFFFFF", "rollOverColor": "#334155", "rollOverAlpha": 1, "alpha": 0.9, "unlistedAreasAlpha": 0.1, "unlistedAreasColor": "#cbd5e1", "balloonText": "<div style='padding:10px; font-family: Inter, sans-serif; line-height:1.6;'><b style='font-size:14px;'>[[title]]</b><br/><span style='font-size:12px; opacity:0.9; margin-top:5px; display:block;'>[[customData]]</span></div>" },
        "balloon": { "adjustBorderColor": false, "color": "#ffffff", "cornerRadius": 8, "fillColor": "#1e293b", "fillAlpha": 0.95, "borderThickness": 0, "shadowAlpha": 0.15 },
        "export": { 
          "enabled": true, 
          "menu": [{ "class": "export-main", "menu": [{ "label": "å¯¼å‡ºåœ°å›¾", "menu": ["PNG", "JPG", "PDF"] }] }],
          "capture": function() {
            addWatermarkForExport('global', true);
            return document.getElementById("chartdiv-global");
          }
        }
      });
      
      // åˆå§‹åŒ–è°ƒè‰²ç›˜
      colorCustomizer.initColorPalette('global', legendTitleToColorKey, COLORS);
    }

    // ä¸­å›½æŠ¤ç…§åœ°å›¾
    function initChinaMap() {
      const defaultColors = { china: "#ef4444", free: "#059669", arrival: "#34D399", evisa: "#A7F3D0", hmt_pass: "#ff9999" };
      const COLORS = {};
      const legendTitleToColorKey = {
        "ä¸­å›½å¤§é™†": "china",
        "éœ€åŠç†æ¸¯æ¾³å°é€šè¡Œè¯": "hmt_pass",
        "å…ç­¾ (äº’å…/å•æ–¹é¢)": "free",
        "è½åœ°ç­¾": "arrival",
        "ç”µå­ç­¾": "evisa"
      };
      
      for (const [key, value] of Object.entries(defaultColors)) {
        COLORS[key] = colorCustomizer.loadColor('china', key, value);
      }
      maps['china'] = AmCharts.makeChart("chartdiv-china", {
        "type": "map", "theme": "light", "projection": "miller",
        "dataProvider": { "map": "worldHigh", "zoomLevel": 1.2, "zoomLongitude": 10, "zoomLatitude": 20, "areas": [
          { "id": "CN", "title": "ä¸­å›½å¤§é™†", "customData": "ä¸­å›½å¤§é™†", "color": COLORS.china },
          { "id": "HK", "title": "ä¸­å›½é¦™æ¸¯", "customData": "éœ€åŠç†æ¸¯æ¾³å°é€šè¡Œè¯", "color": COLORS.hmt_pass },
          { "id": "MO", "title": "ä¸­å›½æ¾³é—¨", "customData": "éœ€åŠç†æ¸¯æ¾³å°é€šè¡Œè¯", "color": COLORS.hmt_pass },
          { "id": "TW", "title": "ä¸­å›½å°æ¹¾", "customData": "éœ€åŠç†æ¸¯æ¾³å°é€šè¡Œè¯", "color": COLORS.hmt_pass },
          { "id": "RU", "title": "ä¿„ç½—æ–¯", "customData": "å…ç­¾", "color": COLORS.free },
          { "id": "KH", "title": "æŸ¬åŸ”å¯¨", "customData": "å…ç­¾", "color": COLORS.free },
          { "id": "TR", "title": "åœŸè€³å…¶", "customData": "å…ç­¾", "color": COLORS.free },
          { "id": "BR", "title": "å·´è¥¿", "customData": "å…ç­¾", "color": COLORS.free },
          { "id": "AE", "title": "é˜¿è”é…‹", "customData": "å…ç­¾", "color": COLORS.free },
          { "id": "BB", "title": "å·´å·´å¤šæ–¯", "customData": "å…ç­¾", "color": COLORS.free },
          { "id": "BS", "title": "å·´å“ˆé©¬", "customData": "å…ç­¾", "color": COLORS.free },
          { "id": "BA", "title": "æ³¢é»‘", "customData": "å…ç­¾", "color": COLORS.free },
          { "id": "FJ", "title": "æ–æµ", "customData": "å…ç­¾", "color": COLORS.free },
          { "id": "GD", "title": "æ ¼æ—çº³è¾¾", "customData": "å…ç­¾", "color": COLORS.free },
          { "id": "MU", "title": "æ¯›é‡Œæ±‚æ–¯", "customData": "å…ç­¾", "color": COLORS.free },
          { "id": "SM", "title": "åœ£é©¬åŠ›è¯º", "customData": "å…ç­¾", "color": COLORS.free },
          { "id": "SC", "title": "å¡èˆŒå°”", "customData": "å…ç­¾", "color": COLORS.free },
          { "id": "RS", "title": "å¡å°”ç»´äºš", "customData": "å…ç­¾", "color": COLORS.free },
          { "id": "TO", "title": "æ±¤åŠ ", "customData": "å…ç­¾", "color": COLORS.free },
          { "id": "BY", "title": "ç™½ä¿„ç½—æ–¯", "customData": "å…ç­¾", "color": COLORS.free },
          { "id": "QA", "title": "å¡å¡”å°”", "customData": "å…ç­¾", "color": COLORS.free },
          { "id": "AM", "title": "äºšç¾å°¼äºš", "customData": "å…ç­¾", "color": COLORS.free },
          { "id": "UZ", "title": "ä¹Œå…¹åˆ«å…‹æ–¯å¦", "customData": "å…ç­¾", "color": COLORS.free },
          { "id": "OM", "title": "é˜¿æ›¼", "customData": "å…ç­¾", "color": COLORS.free },
          { "id": "AL", "title": "é˜¿å°”å·´å°¼äºš", "customData": "å…ç­¾", "color": COLORS.free },
          { "id": "MA", "title": "æ‘©æ´›å“¥", "customData": "å…ç­¾", "color": COLORS.free },
          { "id": "RE", "title": "æ³•å±ç•™å°¼æ±ª", "customData": "å…ç­¾", "color": COLORS.free },
          { "id": "TN", "title": "çªå°¼æ–¯", "customData": "å…ç­¾ï¼ˆéœ€æŸ¥ææ–™ï¼Œæœ‰æ¦‚ç‡æ‹’ç»å…¥å¢ƒï¼‰", "color": COLORS.free },
          { "id": "AG", "title": "å®‰æç“œå’Œå·´å¸ƒè¾¾", "customData": "å…ç­¾", "color": COLORS.free },
          { "id": "HT", "title": "æµ·åœ°", "customData": "å…ç­¾", "color": COLORS.free },
          { "id": "GS", "title": "å—ä¹”æ²»äºšå’Œå—æ¡‘å¨å¥‡ç¾¤å²›", "customData": "å…ç­¾", "color": COLORS.free },
          { "id": "KN", "title": "åœ£åŸºèŒ¨å’Œå°¼ç»´æ–¯", "customData": "å…ç­¾", "color": COLORS.free },
          { "id": "TC", "title": "ç‰¹å…‹æ–¯å’Œå‡¯ç§‘æ–¯ç¾¤å²›", "customData": "å…ç­¾", "color": COLORS.free },
          { "id": "JM", "title": "ç‰™ä¹°åŠ ", "customData": "å…ç­¾", "color": COLORS.free },
          { "id": "DM", "title": "å¤šç±³å°¼å…‹", "customData": "å…ç­¾", "color": COLORS.free },
          { "id": "MP", "title": "å¡ç­å²›", "customData": "å…ç­¾", "color": COLORS.free },
          { "id": "WS", "title": "è¨æ‘©äºš", "customData": "å…ç­¾", "color": COLORS.free },
          { "id": "PF", "title": "æ³•å±æ³¢åˆ©å°¼è¥¿äºš", "customData": "å…ç­¾", "color": COLORS.free },
          { "id": "LC", "title": "åœ£å¢è¥¿äºš", "customData": "å…ç­¾", "color": COLORS.free },
          { "id": "CK", "title": "åº“å…‹ç¾¤å²›", "customData": "å…ç­¾", "color": COLORS.free },
          { "id": "NU", "title": "çº½åŸƒ", "customData": "å…ç­¾", "color": COLORS.free },
          { "id": "IR", "title": "ä¼Šæœ—", "customData": "å…ç­¾", "color": COLORS.free },
          { "id": "ZM", "title": "èµæ¯”äºš", "customData": "å…ç­¾", "color": COLORS.free },
          { "id": "SR", "title": "è‹é‡Œå—", "customData": "å…ç­¾", "color": COLORS.free },
          { "id": "MV", "title": "é©¬å°”ä»£å¤«", "customData": "å…ç­¾", "color": COLORS.free },
          { "id": "KZ", "title": "å“ˆè¨å…‹æ–¯å¦", "customData": "å…ç­¾", "color": COLORS.free },
          { "id": "GA", "title": "åŠ è“¬", "customData": "å…ç­¾", "color": COLORS.free },
          { "id": "MZ", "title": "è«æ¡‘æ¯”å…‹", "customData": "å…ç­¾", "color": COLORS.free },
          { "id": "BJ", "title": "è´å®", "customData": "å…ç­¾", "color": COLORS.free },
          { "id": "AO", "title": "å®‰å“¥æ‹‰", "customData": "å…ç­¾", "color": COLORS.free },
          { "id": "GE", "title": "æ ¼é²å‰äºš", "customData": "å…ç­¾", "color": COLORS.free },
          { "id": "PS", "title": "å·´å‹’æ–¯å¦", "customData": "å…ç­¾", "color": COLORS.free },
          { "id": "TH", "title": "æ³°å›½", "customData": "å…ç­¾", "color": COLORS.free },
          { "id": "MY", "title": "é©¬æ¥è¥¿äºš", "customData": "å…ç­¾", "color": COLORS.free },
          { "id": "SG", "title": "æ–°åŠ å¡", "customData": "å…ç­¾", "color": COLORS.free },
          { "id": "LK", "title": "æ–¯é‡Œå…°å¡", "customData": "å…ç­¾", "color": COLORS.free },
          { "id": "CU", "title": "å¤å·´", "customData": "å…ç­¾", "color": COLORS.free },
          { "id": "AZ", "title": "é˜¿å¡æ‹œç–†", "customData": "å…ç­¾", "color": COLORS.free },
          { "id": "PK", "title": "å·´åŸºæ–¯å¦", "customData": "å…ç­¾", "color": COLORS.free },
          { "id": "VU", "title": "ç“¦åŠªé˜¿å›¾", "customData": "å…ç­¾", "color": COLORS.free },
          { "id": "SB", "title": "æ‰€ç½—é—¨ç¾¤å²›", "customData": "å…ç­¾", "color": COLORS.free },
          { "id": "SJ", "title": "æ–¯ç“¦å°”å·´ç¾¤å²›", "customData": "å…ç­¾", "color": COLORS.free },
          { "id": "AX", "title": "å¥¥å…°ç¾¤å²›", "customData": "å…ç­¾", "color": COLORS.free },
          { "id": "BN", "title": "æ–‡è±", "customData": "è½åœ°ç­¾", "color": COLORS.arrival },
          { "id": "TL", "title": "ä¸œå¸æ±¶", "customData": "è½åœ°ç­¾", "color": COLORS.arrival },
          { "id": "LA", "title": "è€æŒ", "customData": "è½åœ°ç­¾", "color": COLORS.arrival },
          { "id": "LB", "title": "é»å·´å«©", "customData": "è½åœ°ç­¾", "color": COLORS.arrival },
          { "id": "MM", "title": "ç¼…ç”¸", "customData": "è½åœ°ç­¾", "color": COLORS.arrival },
          { "id": "NP", "title": "å°¼æ³Šå°”", "customData": "è½åœ°ç­¾", "color": COLORS.arrival },
          { "id": "JO", "title": "çº¦æ—¦", "customData": "è½åœ°ç­¾", "color": COLORS.arrival },
          { "id": "BD", "title": "å­ŸåŠ æ‹‰å›½", "customData": "è½åœ°ç­¾", "color": COLORS.arrival },
          { "id": "EG", "title": "åŸƒåŠ", "customData": "è½åœ°ç­¾", "color": COLORS.arrival },
          { "id": "TG", "title": "å¤šå“¥", "customData": "è½åœ°ç­¾", "color": COLORS.arrival },
          { "id": "CV", "title": "ä½›å¾—è§’", "customData": "è½åœ°ç­¾", "color": COLORS.arrival },
          { "id": "KM", "title": "ç§‘æ‘©ç½—", "customData": "è½åœ°ç­¾", "color": COLORS.arrival },
          { "id": "RW", "title": "å¢æ—ºè¾¾", "customData": "è½åœ°ç­¾", "color": COLORS.arrival },
          { "id": "MG", "title": "é©¬è¾¾åŠ æ–¯åŠ ", "customData": "è½åœ°ç­¾", "color": COLORS.arrival },
          { "id": "MW", "title": "é©¬æ‹‰ç»´", "customData": "è½åœ°ç­¾", "color": COLORS.arrival },
          { "id": "MR", "title": "æ¯›é‡Œå¡”å°¼äºš", "customData": "è½åœ°ç­¾", "color": COLORS.arrival },
          { "id": "ST", "title": "åœ£å¤šç¾å’Œæ™®æ—è¥¿æ¯”", "customData": "è½åœ°ç­¾", "color": COLORS.arrival },
          { "id": "TZ", "title": "å¦æ¡‘å°¼äºš", "customData": "è½åœ°ç­¾", "color": COLORS.arrival },
          { "id": "UG", "title": "ä¹Œå¹²è¾¾", "customData": "è½åœ°ç­¾", "color": COLORS.arrival },
          { "id": "ZW", "title": "æ´¥å·´å¸ƒéŸ¦", "customData": "è½åœ°ç­¾", "color": COLORS.arrival },
          { "id": "SH", "title": "åœ£èµ«å‹’æ‹¿", "customData": "è½åœ°ç­¾", "color": COLORS.arrival },
          { "id": "PW", "title": "å¸•åŠ³", "customData": "è½åœ°ç­¾", "color": COLORS.arrival },
          { "id": "TV", "title": "å›¾ç“¦å¢", "customData": "è½åœ°ç­¾", "color": COLORS.arrival },
          { "id": "PG", "title": "å·´å¸ƒäºšæ–°å‡ å†…äºš", "customData": "è½åœ°ç­¾", "color": COLORS.arrival },
          { "id": "SA", "title": "æ²™ç‰¹é˜¿æ‹‰ä¼¯", "customData": "è½åœ°ç­¾", "color": COLORS.arrival },
          { "id": "KE", "title": "è‚¯å°¼äºš", "customData": "è½åœ°ç­¾", "color": COLORS.arrival },
          { "id": "GW", "title": "å‡ å†…äºšæ¯”ç»", "customData": "è½åœ°ç­¾", "color": COLORS.arrival },
          { "id": "SL", "title": "å¡æ‹‰åˆ©æ˜‚", "customData": "è½åœ°ç­¾", "color": COLORS.arrival },
          { "id": "ET", "title": "åŸƒå¡ä¿„æ¯”äºš", "customData": "è½åœ°ç­¾", "color": COLORS.arrival },
          { "id": "DJ", "title": "å‰å¸ƒæ", "customData": "è½åœ°ç­¾", "color": COLORS.arrival },
          { "id": "SO", "title": "ç´¢é©¬é‡Œ", "customData": "è½åœ°ç­¾", "color": COLORS.arrival },
          { "id": "BO", "title": "ç»åˆ©ç»´äºš", "customData": "è½åœ°ç­¾", "color": COLORS.arrival },
          { "id": "ID", "title": "å°åº¦å°¼è¥¿äºš", "customData": "è½åœ°ç­¾", "color": COLORS.arrival },
          { "id": "IQ", "title": "ä¼Šæ‹‰å…‹", "customData": "ç”µå­ç­¾", "color": COLORS.evisa },
          { "id": "SN", "title": "å¡å†…åŠ å°”", "customData": "è½åœ°ç­¾", "color": COLORS.arrival },
          { "id": "BI", "title": "å¸ƒéš†è¿ª", "customData": "è½åœ°ç­¾", "color": COLORS.arrival },
          { "id": "NR", "title": "ç‘™é²", "customData": "è½åœ°ç­¾", "color": COLORS.arrival },
          { "id": "KG", "title": "å‰å°”å‰æ–¯æ–¯å¦", "customData": "ç”µå­ç­¾", "color": COLORS.evisa },
          { "id": "TJ", "title": "å¡”å‰å…‹æ–¯å¦", "customData": "ç”µå­ç­¾", "color": COLORS.evisa },
          { "id": "BH", "title": "å·´æ—", "customData": "ç”µå­ç­¾", "color": COLORS.evisa },
          { "id": "GN", "title": "å‡ å†…äºš", "customData": "ç”µå­ç­¾", "color": COLORS.evisa },
          { "id": "LS", "title": "è±ç´¢æ‰˜", "customData": "ç”µå­ç­¾", "color": COLORS.evisa },
          { "id": "MS", "title": "è’™ç‰¹å¡æ‹‰ç‰¹", "customData": "ç”µå­ç­¾", "color": COLORS.evisa },
          { "id": "VN", "title": "è¶Šå—", "customData": "ç”µå­ç­¾", "color": COLORS.evisa },
          { "id": "MN", "title": "è’™å¤", "customData": "ç”µå­ç­¾", "color": COLORS.evisa },
          { "id": "SS", "title": "å—è‹ä¸¹", "customData": "ç”µå­ç­¾", "color": COLORS.evisa },
          { "id": "CD", "title": "åˆšæœ(é‡‘)", "customData": "ç”µå­ç­¾", "color": COLORS.evisa },
          { "id": "NG", "title": "å°¼æ—¥åˆ©äºš", "customData": "ç”µå­ç­¾", "color": COLORS.evisa },
          { "id": "GQ", "title": "èµ¤é“å‡ å†…äºš", "customData": "ç”µå­ç­¾", "color": COLORS.evisa },
          { "id": "CI", "title": "ç§‘ç‰¹è¿ªç“¦", "customData": "ç”µå­ç­¾", "color": COLORS.evisa },
          { "id": "CM", "title": "å–€éº¦éš†", "customData": "ç”µå­ç­¾", "color": COLORS.evisa },
          { "id": "BT", "title": "ä¸ä¸¹", "customData": "ç”µå­ç­¾", "color": COLORS.evisa },
          { "id": "BW", "title": "åšèŒ¨ç“¦çº³", "customData": "ç”µå­ç­¾", "color": COLORS.evisa },
          { "id": "UA", "title": "ä¹Œå…‹å…°", "customData": "ç”µå­ç­¾", "color": COLORS.evisa },
          { "id": "MD", "title": "æ‘©å°”å¤šç“¦", "customData": "ç”µå­ç­¾", "color": COLORS.evisa },
          { "id": "ZA", "title": "å—é", "customData": "ç”µå­ç­¾ETA", "color": COLORS.evisa }
        ]},
        "areasSettings": { "autoZoom": true, "rollOverOutlineColor": "#FFFFFF", "rollOverColor": "#334155", "rollOverAlpha": 1, "alpha": 0.9, "unlistedAreasAlpha": 0.1, "unlistedAreasColor": "#cbd5e1", "balloonText": "<div style='padding:8px; font-family: Inter, sans-serif;'><b>[[title]]</b><br/><span style='font-size:12px; opacity:0.8;'>[[customData]]</span></div>" },
        "balloon": { "adjustBorderColor": false, "color": "#ffffff", "cornerRadius": 8, "fillColor": "#1e293b", "fillAlpha": 0.95, "borderThickness": 0, "shadowAlpha": 0.15 },
        "export": { 
          "enabled": true, 
          "menu": [{ "class": "export-main", "menu": [{ "label": "å¯¼å‡ºåœ°å›¾", "menu": ["PNG", "JPG", "PDF"] }] }],
          "capture": function() {
            addWatermarkForExport('china', true);
            return document.getElementById("chartdiv-china");
          }
        }
      });
      
      // åˆå§‹åŒ–è°ƒè‰²ç›˜
      colorCustomizer.initColorPalette('china', legendTitleToColorKey, COLORS);
    }

    // ç¾å›½ç­¾è¯åœ°å›¾
    function initUSMap() {
      const defaultColors = { us: "#3b82f6", visa_free: "#14b8a6", transit: "#60a5fa", china: "#ef4444", cn_free: "#059669", cn_arrival: "#34D399", cn_evisa: "#A7F3D0", hmt_pass: "#ff9999" };
      const COLORS = {};
      const legendTitleToColorKey = {
        "ä¸­å›½å¤§é™†": "china",
        "éœ€åŠç†æ¸¯æ¾³å°é€šè¡Œè¯": "hmt_pass",
        "ç¾ç­¾ç­¾å‘å›½": "us",
        "æŒç¾ç­¾å…ç­¾": "visa_free",
        "æœ‰æ¡ä»¶è¿‡å¢ƒå…ç­¾": "transit",
        "ä¸­å›½æŠ¤ç…§å…ç­¾": "cn_free",
        "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾": "cn_arrival",
        "ä¸­å›½æŠ¤ç…§ç”µå­ç­¾": "cn_evisa"
      };
      
      for (const [key, value] of Object.entries(defaultColors)) {
        COLORS[key] = colorCustomizer.loadColor('us', key, value);
      }
      maps['us'] = AmCharts.makeChart("chartdiv-us", {
        "type": "map", "theme": "light", "projection": "miller",
        "dataProvider": { "map": "worldHigh", "zoomLevel": 1.2, "zoomLongitude": 20, "zoomLatitude": 30, "areas": [
          { "id": "CN", "title": "ä¸­å›½å¤§é™†", "customData": "ä¸­å›½å¤§é™†", "color": COLORS.china },
          { "id": "HK", "title": "ä¸­å›½é¦™æ¸¯", "customData": "éœ€åŠç†æ¸¯æ¾³å°é€šè¡Œè¯", "color": COLORS.hmt_pass },
          { "id": "MO", "title": "ä¸­å›½æ¾³é—¨", "customData": "éœ€åŠç†æ¸¯æ¾³å°é€šè¡Œè¯", "color": COLORS.hmt_pass },
          { "id": "TW", "title": "ä¸­å›½å°æ¹¾", "customData": "éœ€åŠç†æ¸¯æ¾³å°é€šè¡Œè¯", "color": COLORS.hmt_pass },
          { "id": "US", "title": "ç¾å›½", "customData": "ç¾ç­¾ç­¾å‘å›½", "color": COLORS.us },
          { "id": "MX", "title": "å¢¨è¥¿å“¥", "customData": "æŒç¾ç­¾å…ç­¾180å¤©", "color": COLORS.visa_free },
          { "id": "PA", "title": "å·´æ‹¿é©¬", "customData": "æŒç¾ç­¾å…ç­¾30å¤©", "color": COLORS.visa_free },
          { "id": "CR", "title": "å“¥æ–¯è¾¾é»åŠ ", "customData": "æŒç¾ç­¾å…ç­¾30å¤©", "color": COLORS.visa_free },
          { "id": "CL", "title": "æ™ºåˆ©", "customData": "æŒç¾ç­¾å…ç­¾90å¤©", "color": COLORS.visa_free },
          { "id": "PE", "title": "ç§˜é²", "customData": "æŒç¾ç­¾å…ç­¾180å¤©", "color": COLORS.visa_free },
          { "id": "UY", "title": "ä¹Œæ‹‰åœ­", "customData": "æŒç¾ç­¾å…ç­¾90å¤©", "color": COLORS.visa_free },
          { "id": "CO", "title": "å“¥ä¼¦æ¯”äºš", "customData": "æŒç¾ç­¾å…ç­¾90å¤©", "color": COLORS.visa_free },
          { "id": "DO", "title": "å¤šç±³å°¼åŠ ", "customData": "æŒç¾ç­¾å…ç­¾30å¤©", "color": COLORS.visa_free },
          { "id": "HN", "title": "æ´ªéƒ½æ‹‰æ–¯", "customData": "æŒç¾ç­¾å…ç­¾30å¤©", "color": COLORS.visa_free },
          { "id": "SV", "title": "è¨å°”ç“¦å¤š", "customData": "æŒç¾ç­¾å…ç­¾90å¤©", "color": COLORS.visa_free },
          { "id": "BZ", "title": "ä¼¯åˆ©å…¹", "customData": "æŒç¾ç­¾å…ç­¾30å¤©", "color": COLORS.visa_free },
          { "id": "AR", "title": "é˜¿æ ¹å»·", "customData": "æŒç¾ç­¾å…ç­¾30å¤©", "color": COLORS.visa_free },
          { "id": "BM", "title": "ç™¾æ…•å¤§", "customData": "æŒç¾ç­¾å…ç­¾90å¤©", "color": COLORS.visa_free },
          { "id": "KY", "title": "å¼€æ›¼ç¾¤å²›", "customData": "æŒç¾ç­¾å…ç­¾30å¤©", "color": COLORS.visa_free },
          { "id": "ST", "title": "åœ£å¤šç¾å’Œæ™®æ—è¥¿æ¯”", "customData": "æŒç¾ç­¾å…ç­¾15å¤©", "color": COLORS.visa_free },
          { "id": "MD", "title": "æ‘©å°”å¤šç“¦", "customData": "æŒç¾ç­¾å…ç­¾90å¤©", "color": COLORS.visa_free },
          { "id": "PH", "title": "è²å¾‹å®¾", "customData": "æŒç¾ç­¾å…ç­¾7å¤©", "color": COLORS.visa_free },
          { "id": "MK", "title": "åŒ—é©¬å…¶é¡¿", "customData": "æŒç¾ç­¾å…ç­¾15å¤©", "color": COLORS.visa_free },
          { "id": "ME", "title": "é»‘å±±", "customData": "æŒç¾ç­¾å…ç­¾30å¤©", "color": COLORS.visa_free },
          { "id": "KR", "title": "éŸ©å›½", "customData": "æŒç¾ç­¾æœ‰æ¡ä»¶è¿‡å¢ƒå…ç­¾30å¤©", "color": COLORS.transit },
          { "id": "JP", "title": "æ—¥æœ¬", "customData": "æŒç¾ç­¾æœ‰æ¡ä»¶è¿‡å¢ƒå…ç­¾72å°æ—¶", "color": COLORS.transit },
          { "id": "GB", "title": "è‹±å›½", "customData": "æŒç¾ç­¾æœ‰æ¡ä»¶è¿‡å¢ƒå…ç­¾24å°æ—¶", "color": COLORS.transit },
          { "id": "CW", "title": "åº“æ‹‰ç´¢", "customData": "æŒç¾ç­¾å…ç­¾90å¤©", "color": COLORS.visa_free },
          { "id": "AW", "title": "é˜¿é²å·´", "customData": "æŒç¾ç­¾å…ç­¾90å¤©", "color": COLORS.visa_free },
          { "id": "SX", "title": "è·å±åœ£é©¬ä¸", "customData": "æŒç¾ç­¾å…ç­¾90å¤©", "color": COLORS.visa_free },
          { "id": "BQ", "title": "è·å±åŠ å‹’æ¯”", "customData": "æŒç¾ç­¾å…ç­¾90å¤©", "color": COLORS.visa_free },
          { "id": "RU", "title": "ä¿„ç½—æ–¯", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "KH", "title": "æŸ¬åŸ”å¯¨", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "TR", "title": "åœŸè€³å…¶", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "BR", "title": "å·´è¥¿", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "AE", "title": "é˜¿è”é…‹", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "BB", "title": "å·´å·´å¤šæ–¯", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "BS", "title": "å·´å“ˆé©¬", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "BA", "title": "æ³¢é»‘", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "FJ", "title": "æ–æµ", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "GD", "title": "æ ¼æ—çº³è¾¾", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "MU", "title": "æ¯›é‡Œæ±‚æ–¯", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "SM", "title": "åœ£é©¬åŠ›è¯º", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "SC", "title": "å¡èˆŒå°”", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "RS", "title": "å¡å°”ç»´äºš", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "TO", "title": "æ±¤åŠ ", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "BY", "title": "ç™½ä¿„ç½—æ–¯", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "QA", "title": "å¡å¡”å°”", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "AM", "title": "äºšç¾å°¼äºš", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "UZ", "title": "ä¹Œå…¹åˆ«å…‹æ–¯å¦", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "OM", "title": "é˜¿æ›¼", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "AL", "title": "é˜¿å°”å·´å°¼äºš", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "MA", "title": "æ‘©æ´›å“¥", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "RE", "title": "æ³•å±ç•™å°¼æ±ª", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "TN", "title": "çªå°¼æ–¯", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾ï¼ˆéœ€æŸ¥ææ–™ï¼Œæœ‰æ¦‚ç‡æ‹’ç»å…¥å¢ƒï¼‰", "color": COLORS.cn_free },
          { "id": "AG", "title": "å®‰æç“œå’Œå·´å¸ƒè¾¾", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "HT", "title": "æµ·åœ°", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "GS", "title": "å—ä¹”æ²»äºšå’Œå—æ¡‘å¨å¥‡ç¾¤å²›", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "KN", "title": "åœ£åŸºèŒ¨å’Œå°¼ç»´æ–¯", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "TC", "title": "ç‰¹å…‹æ–¯å’Œå‡¯ç§‘æ–¯ç¾¤å²›", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "JM", "title": "ç‰™ä¹°åŠ ", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "DM", "title": "å¤šç±³å°¼å…‹", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "MP", "title": "å¡ç­å²›", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "WS", "title": "è¨æ‘©äºš", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "PF", "title": "æ³•å±æ³¢åˆ©å°¼è¥¿äºš", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "LC", "title": "åœ£å¢è¥¿äºš", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "CK", "title": "åº“å…‹ç¾¤å²›", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "NU", "title": "çº½åŸƒ", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "IR", "title": "ä¼Šæœ—", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "ZM", "title": "èµæ¯”äºš", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "SR", "title": "è‹é‡Œå—", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "MV", "title": "é©¬å°”ä»£å¤«", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "KZ", "title": "å“ˆè¨å…‹æ–¯å¦", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "GA", "title": "åŠ è“¬", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "MZ", "title": "è«æ¡‘æ¯”å…‹", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "BJ", "title": "è´å®", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "AO", "title": "å®‰å“¥æ‹‰", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "GE", "title": "æ ¼é²å‰äºš", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "PS", "title": "å·´å‹’æ–¯å¦", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "TH", "title": "æ³°å›½", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "MY", "title": "é©¬æ¥è¥¿äºš", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "SG", "title": "æ–°åŠ å¡", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "LK", "title": "æ–¯é‡Œå…°å¡", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "CU", "title": "å¤å·´", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "AZ", "title": "é˜¿å¡æ‹œç–†", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "PK", "title": "å·´åŸºæ–¯å¦", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "VU", "title": "ç“¦åŠªé˜¿å›¾", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "SB", "title": "æ‰€ç½—é—¨ç¾¤å²›", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "SJ", "title": "æ–¯ç“¦å°”å·´ç¾¤å²›", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "AX", "title": "å¥¥å…°ç¾¤å²›", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "BN", "title": "æ–‡è±", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "TL", "title": "ä¸œå¸æ±¶", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "LA", "title": "è€æŒ", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "LB", "title": "é»å·´å«©", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "MM", "title": "ç¼…ç”¸", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "NP", "title": "å°¼æ³Šå°”", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "JO", "title": "çº¦æ—¦", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "BD", "title": "å­ŸåŠ æ‹‰å›½", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "EG", "title": "åŸƒåŠ", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "TG", "title": "å¤šå“¥", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "CV", "title": "ä½›å¾—è§’", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "KM", "title": "ç§‘æ‘©ç½—", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "RW", "title": "å¢æ—ºè¾¾", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "MG", "title": "é©¬è¾¾åŠ æ–¯åŠ ", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "MW", "title": "é©¬æ‹‰ç»´", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "MR", "title": "æ¯›é‡Œå¡”å°¼äºš", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "ST", "title": "åœ£å¤šç¾å’Œæ™®æ—è¥¿æ¯”", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "TZ", "title": "å¦æ¡‘å°¼äºš", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "UG", "title": "ä¹Œå¹²è¾¾", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "ZW", "title": "æ´¥å·´å¸ƒéŸ¦", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "SH", "title": "åœ£èµ«å‹’æ‹¿", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "PW", "title": "å¸•åŠ³", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "TV", "title": "å›¾ç“¦å¢", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "PG", "title": "å·´å¸ƒäºšæ–°å‡ å†…äºš", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "SA", "title": "æ²™ç‰¹é˜¿æ‹‰ä¼¯", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "KE", "title": "è‚¯å°¼äºš", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "GW", "title": "å‡ å†…äºšæ¯”ç»", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "SL", "title": "å¡æ‹‰åˆ©æ˜‚", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "ET", "title": "åŸƒå¡ä¿„æ¯”äºš", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "DJ", "title": "å‰å¸ƒæ", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "SO", "title": "ç´¢é©¬é‡Œ", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "BO", "title": "ç»åˆ©ç»´äºš", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "ID", "title": "å°åº¦å°¼è¥¿äºš", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "SN", "title": "å¡å†…åŠ å°”", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "BI", "title": "å¸ƒéš†è¿ª", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "NR", "title": "ç‘™é²", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "IQ", "title": "ä¼Šæ‹‰å…‹", "customData": "ä¸­å›½æŠ¤ç…§ç”µå­ç­¾", "color": COLORS.cn_evisa },
          { "id": "KG", "title": "å‰å°”å‰æ–¯æ–¯å¦", "customData": "ä¸­å›½æŠ¤ç…§ç”µå­ç­¾", "color": COLORS.cn_evisa },
          { "id": "TJ", "title": "å¡”å‰å…‹æ–¯å¦", "customData": "ä¸­å›½æŠ¤ç…§ç”µå­ç­¾", "color": COLORS.cn_evisa },
          { "id": "BH", "title": "å·´æ—", "customData": "ä¸­å›½æŠ¤ç…§ç”µå­ç­¾", "color": COLORS.cn_evisa },
          { "id": "GN", "title": "å‡ å†…äºš", "customData": "ä¸­å›½æŠ¤ç…§ç”µå­ç­¾", "color": COLORS.cn_evisa },
          { "id": "LS", "title": "è±ç´¢æ‰˜", "customData": "ä¸­å›½æŠ¤ç…§ç”µå­ç­¾", "color": COLORS.cn_evisa },
          { "id": "MS", "title": "è’™ç‰¹å¡æ‹‰ç‰¹", "customData": "ä¸­å›½æŠ¤ç…§ç”µå­ç­¾", "color": COLORS.cn_evisa },
          { "id": "VN", "title": "è¶Šå—", "customData": "ä¸­å›½æŠ¤ç…§ç”µå­ç­¾", "color": COLORS.cn_evisa },
          { "id": "MN", "title": "è’™å¤", "customData": "ä¸­å›½æŠ¤ç…§ç”µå­ç­¾", "color": COLORS.cn_evisa },
          { "id": "SS", "title": "å—è‹ä¸¹", "customData": "ä¸­å›½æŠ¤ç…§ç”µå­ç­¾", "color": COLORS.cn_evisa },
          { "id": "CD", "title": "åˆšæœ(é‡‘)", "customData": "ä¸­å›½æŠ¤ç…§ç”µå­ç­¾", "color": COLORS.cn_evisa },
          { "id": "NG", "title": "å°¼æ—¥åˆ©äºš", "customData": "ä¸­å›½æŠ¤ç…§ç”µå­ç­¾", "color": COLORS.cn_evisa },
          { "id": "GQ", "title": "èµ¤é“å‡ å†…äºš", "customData": "ä¸­å›½æŠ¤ç…§ç”µå­ç­¾", "color": COLORS.cn_evisa },
          { "id": "CI", "title": "ç§‘ç‰¹è¿ªç“¦", "customData": "ä¸­å›½æŠ¤ç…§ç”µå­ç­¾", "color": COLORS.cn_evisa },
          { "id": "CM", "title": "å–€éº¦éš†", "customData": "ä¸­å›½æŠ¤ç…§ç”µå­ç­¾", "color": COLORS.cn_evisa },
          { "id": "BT", "title": "ä¸ä¸¹", "customData": "ä¸­å›½æŠ¤ç…§ç”µå­ç­¾", "color": COLORS.cn_evisa },
          { "id": "BW", "title": "åšèŒ¨ç“¦çº³", "customData": "ä¸­å›½æŠ¤ç…§ç”µå­ç­¾", "color": COLORS.cn_evisa },
          { "id": "UA", "title": "ä¹Œå…‹å…°", "customData": "ä¸­å›½æŠ¤ç…§ç”µå­ç­¾", "color": COLORS.cn_evisa },
          { "id": "MD", "title": "æ‘©å°”å¤šç“¦", "customData": "ä¸­å›½æŠ¤ç…§ç”µå­ç­¾", "color": COLORS.cn_evisa },
          { "id": "ZA", "title": "å—é", "customData": "ä¸­å›½æŠ¤ç…§ç”µå­ç­¾ETA", "color": COLORS.cn_evisa }
        ]},
        "areasSettings": { "autoZoom": true, "rollOverOutlineColor": "#FFFFFF", "rollOverColor": "#334155", "rollOverAlpha": 1, "alpha": 0.9, "unlistedAreasAlpha": 0.1, "unlistedAreasColor": "#cbd5e1", "balloonText": "<div style='padding:8px; font-family: Inter, sans-serif;'><b>[[title]]</b><br/><span style='font-size:12px; opacity:0.8;'>[[customData]]</span></div>" },
        "balloon": { "adjustBorderColor": false, "color": "#ffffff", "cornerRadius": 8, "fillColor": "#1e293b", "fillAlpha": 0.95, "borderThickness": 0, "shadowAlpha": 0.15 },
        "export": { 
          "enabled": true, 
          "menu": [{ "class": "export-main", "menu": [{ "label": "å¯¼å‡ºåœ°å›¾", "menu": ["PNG", "JPG", "PDF"] }] }],
          "capture": function() {
            addWatermarkForExport('us', true);
            return document.getElementById("chartdiv-us");
          }
        }
      });
      
      // åˆå§‹åŒ–è°ƒè‰²ç›˜
      colorCustomizer.initColorPalette('us', legendTitleToColorKey, COLORS);
    }

    // è‹±å›½ç­¾è¯åœ°å›¾
    function initUKMap() {
      const defaultColors = { uk: "#3b82f6", visa_free: "#14b8a6", transit: "#60a5fa", china: "#ef4444", cn_free: "#059669", cn_arrival: "#34D399", cn_evisa: "#A7F3D0", hmt_pass: "#ff9999" };
      const COLORS = {};
      const legendTitleToColorKey = {
        "ä¸­å›½å¤§é™†": "china",
        "éœ€åŠç†æ¸¯æ¾³å°é€šè¡Œè¯": "hmt_pass",
        "è‹±ç­¾ç­¾å‘å›½": "uk",
        "æŒè‹±ç­¾å…ç­¾": "visa_free",
        "æœ‰æ¡ä»¶è¿‡å¢ƒå…ç­¾": "transit",
        "ä¸­å›½æŠ¤ç…§å…ç­¾": "cn_free",
        "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾": "cn_arrival",
        "ä¸­å›½æŠ¤ç…§ç”µå­ç­¾": "cn_evisa"
      };
      
      for (const [key, value] of Object.entries(defaultColors)) {
        COLORS[key] = colorCustomizer.loadColor('uk', key, value);
      }
      maps['uk'] = AmCharts.makeChart("chartdiv-uk", {
        "type": "map", "theme": "light", "projection": "miller",
        "dataProvider": { "map": "worldHigh", "zoomLevel": 1.2, "zoomLongitude": 20, "zoomLatitude": 30, "areas": [
          { "id": "CN", "title": "ä¸­å›½å¤§é™†", "customData": "ä¸­å›½å¤§é™†", "color": COLORS.china },
          { "id": "HK", "title": "ä¸­å›½é¦™æ¸¯", "customData": "éœ€åŠç†æ¸¯æ¾³å°é€šè¡Œè¯", "color": COLORS.hmt_pass },
          { "id": "MO", "title": "ä¸­å›½æ¾³é—¨", "customData": "éœ€åŠç†æ¸¯æ¾³å°é€šè¡Œè¯", "color": COLORS.hmt_pass },
          { "id": "TW", "title": "ä¸­å›½å°æ¹¾", "customData": "éœ€åŠç†æ¸¯æ¾³å°é€šè¡Œè¯", "color": COLORS.hmt_pass },
          { "id": "GB", "title": "è‹±å›½", "customData": "è‹±ç­¾ç­¾å‘å›½", "color": COLORS.uk },
          { "id": "IE", "title": "çˆ±å°”å…°", "customData": "æŒè‹±ç­¾å…ç­¾(éœ€å·²ä½¿ç”¨)", "color": COLORS.visa_free },
          { "id": "GI", "title": "ç›´å¸ƒç½—é™€", "customData": "æŒè‹±ç­¾å…ç­¾(éœ€1å¹´ä»¥ä¸Šæœ‰æ•ˆæœŸ)", "color": COLORS.visa_free },
          { "id": "JE", "title": "æ³½è¥¿å²›", "customData": "æŒè‹±ç­¾å…ç­¾(éœ€æœ‰æ•ˆ)", "color": COLORS.visa_free },
          { "id": "GG", "title": "æ ¹è¥¿å²›", "customData": "æŒè‹±ç­¾å…ç­¾(éœ€æœ‰æ•ˆ)", "color": COLORS.visa_free },
          { "id": "IM", "title": "é©¬æ©å²›", "customData": "æŒè‹±ç­¾å…ç­¾(éœ€æœ‰æ•ˆ)", "color": COLORS.visa_free },
          { "id": "ME", "title": "é»‘å±±", "customData": "æŒè‹±ç­¾å…ç­¾7å¤©", "color": COLORS.visa_free },
          { "id": "MK", "title": "åŒ—é©¬å…¶é¡¿", "customData": "æŒè‹±ç­¾å…ç­¾(6ä¸ªæœˆå†…ä¸è¶…è¿‡90å¤©)", "color": COLORS.visa_free },
          { "id": "MX", "title": "å¢¨è¥¿å“¥", "customData": "æŒè‹±ç­¾å…ç­¾180å¤©", "color": COLORS.visa_free },
          { "id": "DO", "title": "å¤šç±³å°¼åŠ ", "customData": "æŒè‹±ç­¾å…ç­¾30å¤©", "color": COLORS.visa_free },
          { "id": "CR", "title": "å“¥æ–¯è¾¾é»åŠ ", "customData": "æŒè‹±ç­¾å…ç­¾30å¤©", "color": COLORS.visa_free },
          { "id": "PA", "title": "å·´æ‹¿é©¬", "customData": "æŒè‹±ç­¾å…ç­¾30å¤©", "color": COLORS.visa_free },
          { "id": "PE", "title": "ç§˜é²", "customData": "æŒè‹±ç­¾å…ç­¾180å¤©", "color": COLORS.visa_free },
          { "id": "BM", "title": "ç™¾æ…•å¤§", "customData": "æŒè‹±ç­¾å…ç­¾180å¤©", "color": COLORS.visa_free },
          { "id": "KY", "title": "å¼€æ›¼ç¾¤å²›", "customData": "æŒè‹±ç­¾å…ç­¾", "color": COLORS.visa_free },
          { "id": "AI", "title": "å®‰åœ­æ‹‰", "customData": "æŒè‹±ç­¾å…ç­¾(éœ€æœ‰æ•ˆ)", "color": COLORS.visa_free },
          { "id": "MD", "title": "æ‘©å°”å¤šç“¦", "customData": "æŒè‹±ç­¾å…ç­¾", "color": COLORS.visa_free },
          { "id": "FJ", "title": "æ–æµ", "customData": "æŒè‹±ç­¾å…ç­¾4ä¸ªæœˆ(éœ€6ä¸ªæœˆæœ‰æ•ˆæœŸ)", "color": COLORS.visa_free },
          { "id": "KR", "title": "éŸ©å›½", "customData": "æŒè‹±ç­¾æœ‰æ¡ä»¶è¿‡å¢ƒå…ç­¾30å¤©", "color": COLORS.transit },
          { "id": "RU", "title": "ä¿„ç½—æ–¯", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "KH", "title": "æŸ¬åŸ”å¯¨", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "TR", "title": "åœŸè€³å…¶", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "BR", "title": "å·´è¥¿", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "AE", "title": "é˜¿è”é…‹", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "BB", "title": "å·´å·´å¤šæ–¯", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "BS", "title": "å·´å“ˆé©¬", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "BA", "title": "æ³¢é»‘", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "SM", "title": "åœ£é©¬åŠ›è¯º", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "SC", "title": "å¡èˆŒå°”", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "RS", "title": "å¡å°”ç»´äºš", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "TO", "title": "æ±¤åŠ ", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "BY", "title": "ç™½ä¿„ç½—æ–¯", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "QA", "title": "å¡å¡”å°”", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "AM", "title": "äºšç¾å°¼äºš", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "UZ", "title": "ä¹Œå…¹åˆ«å…‹æ–¯å¦", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "OM", "title": "é˜¿æ›¼", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "AL", "title": "é˜¿å°”å·´å°¼äºš", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "MA", "title": "æ‘©æ´›å“¥", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "RE", "title": "æ³•å±ç•™å°¼æ±ª", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "TN", "title": "çªå°¼æ–¯", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾ï¼ˆéœ€æŸ¥ææ–™ï¼Œæœ‰æ¦‚ç‡æ‹’ç»å…¥å¢ƒï¼‰", "color": COLORS.cn_free },
          { "id": "AG", "title": "å®‰æç“œå’Œå·´å¸ƒè¾¾", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "HT", "title": "æµ·åœ°", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "GS", "title": "å—ä¹”æ²»äºšå’Œå—æ¡‘å¨å¥‡ç¾¤å²›", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "KN", "title": "åœ£åŸºèŒ¨å’Œå°¼ç»´æ–¯", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "TC", "title": "ç‰¹å…‹æ–¯å’Œå‡¯ç§‘æ–¯ç¾¤å²›", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "JM", "title": "ç‰™ä¹°åŠ ", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "DM", "title": "å¤šç±³å°¼å…‹", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "MP", "title": "å¡ç­å²›", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "WS", "title": "è¨æ‘©äºš", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "PF", "title": "æ³•å±æ³¢åˆ©å°¼è¥¿äºš", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "LC", "title": "åœ£å¢è¥¿äºš", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "CK", "title": "åº“å…‹ç¾¤å²›", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "NU", "title": "çº½åŸƒ", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "IR", "title": "ä¼Šæœ—", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "ZM", "title": "èµæ¯”äºš", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "SR", "title": "è‹é‡Œå—", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "MV", "title": "é©¬å°”ä»£å¤«", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "KZ", "title": "å“ˆè¨å…‹æ–¯å¦", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "GA", "title": "åŠ è“¬", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "MZ", "title": "è«æ¡‘æ¯”å…‹", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "BJ", "title": "è´å®", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "AO", "title": "å®‰å“¥æ‹‰", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "GE", "title": "æ ¼é²å‰äºš", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "PS", "title": "å·´å‹’æ–¯å¦", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "TH", "title": "æ³°å›½", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "MY", "title": "é©¬æ¥è¥¿äºš", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "SG", "title": "æ–°åŠ å¡", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "LK", "title": "æ–¯é‡Œå…°å¡", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "CU", "title": "å¤å·´", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "AZ", "title": "é˜¿å¡æ‹œç–†", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "PK", "title": "å·´åŸºæ–¯å¦", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "VU", "title": "ç“¦åŠªé˜¿å›¾", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "SB", "title": "æ‰€ç½—é—¨ç¾¤å²›", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "SJ", "title": "æ–¯ç“¦å°”å·´ç¾¤å²›", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "AX", "title": "å¥¥å…°ç¾¤å²›", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "GD", "title": "æ ¼æ—çº³è¾¾", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "MU", "title": "æ¯›é‡Œæ±‚æ–¯", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "BN", "title": "æ–‡è±", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "TL", "title": "ä¸œå¸æ±¶", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "LA", "title": "è€æŒ", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "LB", "title": "é»å·´å«©", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "MM", "title": "ç¼…ç”¸", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "NP", "title": "å°¼æ³Šå°”", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "JO", "title": "çº¦æ—¦", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "BD", "title": "å­ŸåŠ æ‹‰å›½", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "EG", "title": "åŸƒåŠ", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "TG", "title": "å¤šå“¥", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "CV", "title": "ä½›å¾—è§’", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "KM", "title": "ç§‘æ‘©ç½—", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "RW", "title": "å¢æ—ºè¾¾", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "MG", "title": "é©¬è¾¾åŠ æ–¯åŠ ", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "MW", "title": "é©¬æ‹‰ç»´", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "MR", "title": "æ¯›é‡Œå¡”å°¼äºš", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "ST", "title": "åœ£å¤šç¾å’Œæ™®æ—è¥¿æ¯”", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "TZ", "title": "å¦æ¡‘å°¼äºš", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "UG", "title": "ä¹Œå¹²è¾¾", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "ZW", "title": "æ´¥å·´å¸ƒéŸ¦", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "SH", "title": "åœ£èµ«å‹’æ‹¿", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "PW", "title": "å¸•åŠ³", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "TV", "title": "å›¾ç“¦å¢", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "PG", "title": "å·´å¸ƒäºšæ–°å‡ å†…äºš", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "SA", "title": "æ²™ç‰¹é˜¿æ‹‰ä¼¯", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "KE", "title": "è‚¯å°¼äºš", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "GW", "title": "å‡ å†…äºšæ¯”ç»", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "SL", "title": "å¡æ‹‰åˆ©æ˜‚", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "ET", "title": "åŸƒå¡ä¿„æ¯”äºš", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "DJ", "title": "å‰å¸ƒæ", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "SO", "title": "ç´¢é©¬é‡Œ", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "BO", "title": "ç»åˆ©ç»´äºš", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "ID", "title": "å°åº¦å°¼è¥¿äºš", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "SN", "title": "å¡å†…åŠ å°”", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "BI", "title": "å¸ƒéš†è¿ª", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "NR", "title": "ç‘™é²", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "IQ", "title": "ä¼Šæ‹‰å…‹", "customData": "ä¸­å›½æŠ¤ç…§ç”µå­ç­¾", "color": COLORS.cn_evisa },
          { "id": "KG", "title": "å‰å°”å‰æ–¯æ–¯å¦", "customData": "ä¸­å›½æŠ¤ç…§ç”µå­ç­¾", "color": COLORS.cn_evisa },
          { "id": "TJ", "title": "å¡”å‰å…‹æ–¯å¦", "customData": "ä¸­å›½æŠ¤ç…§ç”µå­ç­¾", "color": COLORS.cn_evisa },
          { "id": "BH", "title": "å·´æ—", "customData": "ä¸­å›½æŠ¤ç…§ç”µå­ç­¾", "color": COLORS.cn_evisa },
          { "id": "GN", "title": "å‡ å†…äºš", "customData": "ä¸­å›½æŠ¤ç…§ç”µå­ç­¾", "color": COLORS.cn_evisa },
          { "id": "LS", "title": "è±ç´¢æ‰˜", "customData": "ä¸­å›½æŠ¤ç…§ç”µå­ç­¾", "color": COLORS.cn_evisa },
          { "id": "MS", "title": "è’™ç‰¹å¡æ‹‰ç‰¹", "customData": "ä¸­å›½æŠ¤ç…§ç”µå­ç­¾", "color": COLORS.cn_evisa },
          { "id": "VN", "title": "è¶Šå—", "customData": "ä¸­å›½æŠ¤ç…§ç”µå­ç­¾", "color": COLORS.cn_evisa },
          { "id": "MN", "title": "è’™å¤", "customData": "ä¸­å›½æŠ¤ç…§ç”µå­ç­¾", "color": COLORS.cn_evisa },
          { "id": "SS", "title": "å—è‹ä¸¹", "customData": "ä¸­å›½æŠ¤ç…§ç”µå­ç­¾", "color": COLORS.cn_evisa },
          { "id": "CD", "title": "åˆšæœ(é‡‘)", "customData": "ä¸­å›½æŠ¤ç…§ç”µå­ç­¾", "color": COLORS.cn_evisa },
          { "id": "NG", "title": "å°¼æ—¥åˆ©äºš", "customData": "ä¸­å›½æŠ¤ç…§ç”µå­ç­¾", "color": COLORS.cn_evisa },
          { "id": "GQ", "title": "èµ¤é“å‡ å†…äºš", "customData": "ä¸­å›½æŠ¤ç…§ç”µå­ç­¾", "color": COLORS.cn_evisa },
          { "id": "CI", "title": "ç§‘ç‰¹è¿ªç“¦", "customData": "ä¸­å›½æŠ¤ç…§ç”µå­ç­¾", "color": COLORS.cn_evisa },
          { "id": "CM", "title": "å–€éº¦éš†", "customData": "ä¸­å›½æŠ¤ç…§ç”µå­ç­¾", "color": COLORS.cn_evisa },
          { "id": "BT", "title": "ä¸ä¸¹", "customData": "ä¸­å›½æŠ¤ç…§ç”µå­ç­¾", "color": COLORS.cn_evisa },
          { "id": "BW", "title": "åšèŒ¨ç“¦çº³", "customData": "ä¸­å›½æŠ¤ç…§ç”µå­ç­¾", "color": COLORS.cn_evisa },
          { "id": "UA", "title": "ä¹Œå…‹å…°", "customData": "ä¸­å›½æŠ¤ç…§ç”µå­ç­¾", "color": COLORS.cn_evisa },
          { "id": "MD", "title": "æ‘©å°”å¤šç“¦", "customData": "ä¸­å›½æŠ¤ç…§ç”µå­ç­¾", "color": COLORS.cn_evisa },
          { "id": "ZA", "title": "å—é", "customData": "ä¸­å›½æŠ¤ç…§ç”µå­ç­¾ETA", "color": COLORS.cn_evisa }
        ]},
        "areasSettings": { "autoZoom": true, "rollOverOutlineColor": "#FFFFFF", "rollOverColor": "#334155", "rollOverAlpha": 1, "alpha": 0.9, "unlistedAreasAlpha": 0.1, "unlistedAreasColor": "#cbd5e1", "balloonText": "<div style='padding:8px; font-family: Inter, sans-serif;'><b>[[title]]</b><br/><span style='font-size:12px; opacity:0.8;'>[[customData]]</span></div>" },
        "balloon": { "adjustBorderColor": false, "color": "#ffffff", "cornerRadius": 8, "fillColor": "#1e293b", "fillAlpha": 0.95, "borderThickness": 0, "shadowAlpha": 0.15 },
        "export": { 
          "enabled": true, 
          "menu": [{ "class": "export-main", "menu": [{ "label": "å¯¼å‡ºåœ°å›¾", "menu": ["PNG", "JPG", "PDF"] }] }],
          "capture": function() {
            addWatermarkForExport('uk', true);
            return document.getElementById("chartdiv-uk");
          }
        }
      });
      
      // åˆå§‹åŒ–è°ƒè‰²ç›˜
      colorCustomizer.initColorPalette('uk', legendTitleToColorKey, COLORS);
    }

    // æ—¥æœ¬ç­¾è¯åœ°å›¾
    function initJapanMap() {
      const defaultColors = { japan: "#3b82f6", visa_free: "#14b8a6", china: "#ef4444", cn_free: "#059669", cn_arrival: "#34D399", cn_evisa: "#A7F3D0", hmt_pass: "#ff9999" };
      const COLORS = {};
      const legendTitleToColorKey = {
        "ä¸­å›½å¤§é™†": "china",
        "éœ€åŠç†æ¸¯æ¾³å°é€šè¡Œè¯": "hmt_pass",
        "æ—¥ç­¾ç­¾å‘å›½": "japan",
        "æŒæ—¥ç­¾å…ç­¾": "visa_free",
        "ä¸­å›½æŠ¤ç…§å…ç­¾": "cn_free",
        "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾": "cn_arrival",
        "ä¸­å›½æŠ¤ç…§ç”µå­ç­¾": "cn_evisa"
      };
      
      for (const [key, value] of Object.entries(defaultColors)) {
        COLORS[key] = colorCustomizer.loadColor('japan', key, value);
      }
      maps['japan'] = AmCharts.makeChart("chartdiv-japan", {
        "type": "map", "theme": "light", "projection": "miller",
        "dataProvider": { "map": "worldHigh", "zoomLevel": 1.2, "zoomLongitude": 20, "zoomLatitude": 30, "areas": [
          { "id": "CN", "title": "ä¸­å›½å¤§é™†", "customData": "ä¸­å›½å¤§é™†", "color": COLORS.china },
          { "id": "HK", "title": "ä¸­å›½é¦™æ¸¯", "customData": "éœ€åŠç†æ¸¯æ¾³å°é€šè¡Œè¯", "color": COLORS.hmt_pass },
          { "id": "MO", "title": "ä¸­å›½æ¾³é—¨", "customData": "éœ€åŠç†æ¸¯æ¾³å°é€šè¡Œè¯", "color": COLORS.hmt_pass },
          { "id": "TW", "title": "ä¸­å›½å°æ¹¾", "customData": "éœ€åŠç†æ¸¯æ¾³å°é€šè¡Œè¯", "color": COLORS.hmt_pass },
          { "id": "JP", "title": "æ—¥æœ¬", "customData": "æ—¥ç­¾ç­¾å‘å›½", "color": COLORS.japan },
          { "id": "PH", "title": "è²å¾‹å®¾", "customData": "æŒå•æ¬¡æˆ–å¤šæ¬¡æ—¥ç­¾å…ç­¾7å¤©", "color": COLORS.visa_free },
          { "id": "MX", "title": "å¢¨è¥¿å“¥", "customData": "æŒæ—¥ç­¾å…ç­¾180å¤©", "color": COLORS.visa_free },
          { "id": "ME", "title": "é»‘å±±", "customData": "æŒæ—¥ç­¾å…ç­¾30å¤©", "color": COLORS.visa_free },
          { "id": "PA", "title": "å·´æ‹¿é©¬", "customData": "æŒæ—¥ç­¾å…ç­¾30å¤©", "color": COLORS.visa_free },
          { "id": "RU", "title": "ä¿„ç½—æ–¯", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "KH", "title": "æŸ¬åŸ”å¯¨", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "TR", "title": "åœŸè€³å…¶", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "BR", "title": "å·´è¥¿", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "AE", "title": "é˜¿è”é…‹", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "BB", "title": "å·´å·´å¤šæ–¯", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "BS", "title": "å·´å“ˆé©¬", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "BA", "title": "æ³¢é»‘", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "FJ", "title": "æ–æµ", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "GD", "title": "æ ¼æ—çº³è¾¾", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "MU", "title": "æ¯›é‡Œæ±‚æ–¯", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "SM", "title": "åœ£é©¬åŠ›è¯º", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "SC", "title": "å¡èˆŒå°”", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "RS", "title": "å¡å°”ç»´äºš", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "TO", "title": "æ±¤åŠ ", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "BY", "title": "ç™½ä¿„ç½—æ–¯", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "QA", "title": "å¡å¡”å°”", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "AM", "title": "äºšç¾å°¼äºš", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "UZ", "title": "ä¹Œå…¹åˆ«å…‹æ–¯å¦", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "OM", "title": "é˜¿æ›¼", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "AL", "title": "é˜¿å°”å·´å°¼äºš", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "MA", "title": "æ‘©æ´›å“¥", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "RE", "title": "æ³•å±ç•™å°¼æ±ª", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "TN", "title": "çªå°¼æ–¯", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾ï¼ˆéœ€æŸ¥ææ–™ï¼Œæœ‰æ¦‚ç‡æ‹’ç»å…¥å¢ƒï¼‰", "color": COLORS.cn_free },
          { "id": "AG", "title": "å®‰æç“œå’Œå·´å¸ƒè¾¾", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "HT", "title": "æµ·åœ°", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "GS", "title": "å—ä¹”æ²»äºšå’Œå—æ¡‘å¨å¥‡ç¾¤å²›", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "KN", "title": "åœ£åŸºèŒ¨å’Œå°¼ç»´æ–¯", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "TC", "title": "ç‰¹å…‹æ–¯å’Œå‡¯ç§‘æ–¯ç¾¤å²›", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "JM", "title": "ç‰™ä¹°åŠ ", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "DM", "title": "å¤šç±³å°¼å…‹", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "MP", "title": "å¡ç­å²›", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "WS", "title": "è¨æ‘©äºš", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "PF", "title": "æ³•å±æ³¢åˆ©å°¼è¥¿äºš", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "LC", "title": "åœ£å¢è¥¿äºš", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "CK", "title": "åº“å…‹ç¾¤å²›", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "NU", "title": "çº½åŸƒ", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "IR", "title": "ä¼Šæœ—", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "ZM", "title": "èµæ¯”äºš", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "SR", "title": "è‹é‡Œå—", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "MV", "title": "é©¬å°”ä»£å¤«", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "KZ", "title": "å“ˆè¨å…‹æ–¯å¦", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "GA", "title": "åŠ è“¬", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "MZ", "title": "è«æ¡‘æ¯”å…‹", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "BJ", "title": "è´å®", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "AO", "title": "å®‰å“¥æ‹‰", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "GE", "title": "æ ¼é²å‰äºš", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "PS", "title": "å·´å‹’æ–¯å¦", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "TH", "title": "æ³°å›½", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "MY", "title": "é©¬æ¥è¥¿äºš", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "SG", "title": "æ–°åŠ å¡", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "LK", "title": "æ–¯é‡Œå…°å¡", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "CU", "title": "å¤å·´", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "AZ", "title": "é˜¿å¡æ‹œç–†", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "PK", "title": "å·´åŸºæ–¯å¦", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "VU", "title": "ç“¦åŠªé˜¿å›¾", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "SB", "title": "æ‰€ç½—é—¨ç¾¤å²›", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "SJ", "title": "æ–¯ç“¦å°”å·´ç¾¤å²›", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "AX", "title": "å¥¥å…°ç¾¤å²›", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "BN", "title": "æ–‡è±", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "TL", "title": "ä¸œå¸æ±¶", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "LA", "title": "è€æŒ", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "LB", "title": "é»å·´å«©", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "MM", "title": "ç¼…ç”¸", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "NP", "title": "å°¼æ³Šå°”", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "JO", "title": "çº¦æ—¦", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "BD", "title": "å­ŸåŠ æ‹‰å›½", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "EG", "title": "åŸƒåŠ", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "TG", "title": "å¤šå“¥", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "CV", "title": "ä½›å¾—è§’", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "KM", "title": "ç§‘æ‘©ç½—", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "RW", "title": "å¢æ—ºè¾¾", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "MG", "title": "é©¬è¾¾åŠ æ–¯åŠ ", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "MW", "title": "é©¬æ‹‰ç»´", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "MR", "title": "æ¯›é‡Œå¡”å°¼äºš", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "ST", "title": "åœ£å¤šç¾å’Œæ™®æ—è¥¿æ¯”", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "TZ", "title": "å¦æ¡‘å°¼äºš", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "UG", "title": "ä¹Œå¹²è¾¾", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "ZW", "title": "æ´¥å·´å¸ƒéŸ¦", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "SH", "title": "åœ£èµ«å‹’æ‹¿", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "PW", "title": "å¸•åŠ³", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "TV", "title": "å›¾ç“¦å¢", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "PG", "title": "å·´å¸ƒäºšæ–°å‡ å†…äºš", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "SA", "title": "æ²™ç‰¹é˜¿æ‹‰ä¼¯", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "KE", "title": "è‚¯å°¼äºš", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "GW", "title": "å‡ å†…äºšæ¯”ç»", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "SL", "title": "å¡æ‹‰åˆ©æ˜‚", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "ET", "title": "åŸƒå¡ä¿„æ¯”äºš", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "DJ", "title": "å‰å¸ƒæ", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "SO", "title": "ç´¢é©¬é‡Œ", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "BO", "title": "ç»åˆ©ç»´äºš", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "ID", "title": "å°åº¦å°¼è¥¿äºš", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "SN", "title": "å¡å†…åŠ å°”", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "BI", "title": "å¸ƒéš†è¿ª", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "NR", "title": "ç‘™é²", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "IQ", "title": "ä¼Šæ‹‰å…‹", "customData": "ä¸­å›½æŠ¤ç…§ç”µå­ç­¾", "color": COLORS.cn_evisa },
          { "id": "KG", "title": "å‰å°”å‰æ–¯æ–¯å¦", "customData": "ä¸­å›½æŠ¤ç…§ç”µå­ç­¾", "color": COLORS.cn_evisa },
          { "id": "TJ", "title": "å¡”å‰å…‹æ–¯å¦", "customData": "ä¸­å›½æŠ¤ç…§ç”µå­ç­¾", "color": COLORS.cn_evisa },
          { "id": "BH", "title": "å·´æ—", "customData": "ä¸­å›½æŠ¤ç…§ç”µå­ç­¾", "color": COLORS.cn_evisa },
          { "id": "GN", "title": "å‡ å†…äºš", "customData": "ä¸­å›½æŠ¤ç…§ç”µå­ç­¾", "color": COLORS.cn_evisa },
          { "id": "LS", "title": "è±ç´¢æ‰˜", "customData": "ä¸­å›½æŠ¤ç…§ç”µå­ç­¾", "color": COLORS.cn_evisa },
          { "id": "MS", "title": "è’™ç‰¹å¡æ‹‰ç‰¹", "customData": "ä¸­å›½æŠ¤ç…§ç”µå­ç­¾", "color": COLORS.cn_evisa },
          { "id": "VN", "title": "è¶Šå—", "customData": "ä¸­å›½æŠ¤ç…§ç”µå­ç­¾", "color": COLORS.cn_evisa },
          { "id": "MN", "title": "è’™å¤", "customData": "ä¸­å›½æŠ¤ç…§ç”µå­ç­¾", "color": COLORS.cn_evisa },
          { "id": "SS", "title": "å—è‹ä¸¹", "customData": "ä¸­å›½æŠ¤ç…§ç”µå­ç­¾", "color": COLORS.cn_evisa },
          { "id": "CD", "title": "åˆšæœ(é‡‘)", "customData": "ä¸­å›½æŠ¤ç…§ç”µå­ç­¾", "color": COLORS.cn_evisa },
          { "id": "NG", "title": "å°¼æ—¥åˆ©äºš", "customData": "ä¸­å›½æŠ¤ç…§ç”µå­ç­¾", "color": COLORS.cn_evisa },
          { "id": "GQ", "title": "èµ¤é“å‡ å†…äºš", "customData": "ä¸­å›½æŠ¤ç…§ç”µå­ç­¾", "color": COLORS.cn_evisa },
          { "id": "CI", "title": "ç§‘ç‰¹è¿ªç“¦", "customData": "ä¸­å›½æŠ¤ç…§ç”µå­ç­¾", "color": COLORS.cn_evisa },
          { "id": "CM", "title": "å–€éº¦éš†", "customData": "ä¸­å›½æŠ¤ç…§ç”µå­ç­¾", "color": COLORS.cn_evisa },
          { "id": "BT", "title": "ä¸ä¸¹", "customData": "ä¸­å›½æŠ¤ç…§ç”µå­ç­¾", "color": COLORS.cn_evisa },
          { "id": "BW", "title": "åšèŒ¨ç“¦çº³", "customData": "ä¸­å›½æŠ¤ç…§ç”µå­ç­¾", "color": COLORS.cn_evisa },
          { "id": "UA", "title": "ä¹Œå…‹å…°", "customData": "ä¸­å›½æŠ¤ç…§ç”µå­ç­¾", "color": COLORS.cn_evisa },
          { "id": "MD", "title": "æ‘©å°”å¤šç“¦", "customData": "ä¸­å›½æŠ¤ç…§ç”µå­ç­¾", "color": COLORS.cn_evisa },
          { "id": "ZA", "title": "å—é", "customData": "ä¸­å›½æŠ¤ç…§ç”µå­ç­¾ETA", "color": COLORS.cn_evisa }
        ]},
        "areasSettings": { "autoZoom": true, "rollOverOutlineColor": "#FFFFFF", "rollOverColor": "#334155", "rollOverAlpha": 1, "alpha": 0.9, "unlistedAreasAlpha": 0.1, "unlistedAreasColor": "#cbd5e1", "balloonText": "<div style='padding:8px; font-family: Inter, sans-serif;'><b>[[title]]</b><br/><span style='font-size:12px; opacity:0.8;'>[[customData]]</span></div>" },
        "balloon": { "adjustBorderColor": false, "color": "#ffffff", "cornerRadius": 8, "fillColor": "#1e293b", "fillAlpha": 0.95, "borderThickness": 0, "shadowAlpha": 0.15 },
        "export": { 
          "enabled": true, 
          "menu": [{ "class": "export-main", "menu": [{ "label": "å¯¼å‡ºåœ°å›¾", "menu": ["PNG", "JPG", "PDF"] }] }],
          "capture": function() {
            addWatermarkForExport('japan', true);
            return document.getElementById("chartdiv-japan");
          }
        }
      });
      
      // åˆå§‹åŒ–è°ƒè‰²ç›˜
      colorCustomizer.initColorPalette('japan', legendTitleToColorKey, COLORS);
    }

    // æ¾³æ´²ç­¾è¯åœ°å›¾
    function initAustraliaMap() {
      const defaultColors = { australia: "#3b82f6", visa_free: "#14b8a6", transit: "#60a5fa", china: "#ef4444", cn_free: "#059669", cn_arrival: "#34D399", cn_evisa: "#A7F3D0", hmt_pass: "#ff9999" };
      const COLORS = {};
      const legendTitleToColorKey = {
        "ä¸­å›½å¤§é™†": "china",
        "éœ€åŠç†æ¸¯æ¾³å°é€šè¡Œè¯": "hmt_pass",
        "æ¾³ç­¾ç­¾å‘å›½": "australia",
        "æŒæ¾³ç­¾å…ç­¾": "visa_free",
        "æœ‰æ¡ä»¶è¿‡å¢ƒå…ç­¾": "transit",
        "ä¸­å›½æŠ¤ç…§å…ç­¾": "cn_free",
        "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾": "cn_arrival",
        "ä¸­å›½æŠ¤ç…§ç”µå­ç­¾": "cn_evisa"
      };
      
      for (const [key, value] of Object.entries(defaultColors)) {
        COLORS[key] = colorCustomizer.loadColor('australia', key, value);
      }
      maps['australia'] = AmCharts.makeChart("chartdiv-australia", {
        "type": "map", "theme": "light", "projection": "miller",
        "dataProvider": { "map": "worldHigh", "zoomLevel": 1.2, "zoomLongitude": 20, "zoomLatitude": 30, "areas": [
          { "id": "CN", "title": "ä¸­å›½å¤§é™†", "customData": "ä¸­å›½å¤§é™†", "color": COLORS.china },
          { "id": "HK", "title": "ä¸­å›½é¦™æ¸¯", "customData": "éœ€åŠç†æ¸¯æ¾³å°é€šè¡Œè¯", "color": COLORS.hmt_pass },
          { "id": "MO", "title": "ä¸­å›½æ¾³é—¨", "customData": "éœ€åŠç†æ¸¯æ¾³å°é€šè¡Œè¯", "color": COLORS.hmt_pass },
          { "id": "TW", "title": "ä¸­å›½å°æ¹¾", "customData": "éœ€åŠç†æ¸¯æ¾³å°é€šè¡Œè¯", "color": COLORS.hmt_pass },
          { "id": "AU", "title": "æ¾³å¤§åˆ©äºš", "customData": "æ¾³ç­¾ç­¾å‘å›½", "color": COLORS.australia },
          { "id": "NZ", "title": "æ–°è¥¿å…°", "customData": "æŒæ¾³ç­¾å…ç­¾(éœ€å…ˆä»æ¾³æ´²å…¥å¢ƒï¼Œç”³è¯·NZeTA)", "color": COLORS.visa_free },
          { "id": "PA", "title": "å·´æ‹¿é©¬", "customData": "æŒæ¾³ç­¾å…ç­¾(éœ€å·²ä½¿ç”¨1æ¬¡ä»¥ä¸Š)", "color": COLORS.visa_free },
          { "id": "PH", "title": "è²å¾‹å®¾", "customData": "æŒæ¾³ç­¾å…ç­¾7å¤©", "color": COLORS.visa_free },
          { "id": "PE", "title": "ç§˜é²", "customData": "æŒæ¾³ç­¾å…ç­¾180å¤©", "color": COLORS.visa_free },
          { "id": "KR", "title": "éŸ©å›½", "customData": "æŒæ¾³ç­¾æœ‰æ¡ä»¶è¿‡å¢ƒå…ç­¾30å¤©", "color": COLORS.transit },
          { "id": "JP", "title": "æ—¥æœ¬", "customData": "æŒæ¾³ç­¾æœ‰æ¡ä»¶è¿‡å¢ƒå…ç­¾72å°æ—¶(éœ€é¢„è®¢å¤§èˆªå¸æœºç¥¨)", "color": COLORS.transit },
          { "id": "RU", "title": "ä¿„ç½—æ–¯", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "KH", "title": "æŸ¬åŸ”å¯¨", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "TR", "title": "åœŸè€³å…¶", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "BR", "title": "å·´è¥¿", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "AE", "title": "é˜¿è”é…‹", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "BB", "title": "å·´å·´å¤šæ–¯", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "BS", "title": "å·´å“ˆé©¬", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "BA", "title": "æ³¢é»‘", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "FJ", "title": "æ–æµ", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "GD", "title": "æ ¼æ—çº³è¾¾", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "MU", "title": "æ¯›é‡Œæ±‚æ–¯", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "SM", "title": "åœ£é©¬åŠ›è¯º", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "SC", "title": "å¡èˆŒå°”", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "RS", "title": "å¡å°”ç»´äºš", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "TO", "title": "æ±¤åŠ ", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "BY", "title": "ç™½ä¿„ç½—æ–¯", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "QA", "title": "å¡å¡”å°”", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "AM", "title": "äºšç¾å°¼äºš", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "UZ", "title": "ä¹Œå…¹åˆ«å…‹æ–¯å¦", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "OM", "title": "é˜¿æ›¼", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "AL", "title": "é˜¿å°”å·´å°¼äºš", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "MA", "title": "æ‘©æ´›å“¥", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "RE", "title": "æ³•å±ç•™å°¼æ±ª", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "TN", "title": "çªå°¼æ–¯", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾ï¼ˆéœ€æŸ¥ææ–™ï¼Œæœ‰æ¦‚ç‡æ‹’ç»å…¥å¢ƒï¼‰", "color": COLORS.cn_free },
          { "id": "AG", "title": "å®‰æç“œå’Œå·´å¸ƒè¾¾", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "HT", "title": "æµ·åœ°", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "GS", "title": "å—ä¹”æ²»äºšå’Œå—æ¡‘å¨å¥‡ç¾¤å²›", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "KN", "title": "åœ£åŸºèŒ¨å’Œå°¼ç»´æ–¯", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "TC", "title": "ç‰¹å…‹æ–¯å’Œå‡¯ç§‘æ–¯ç¾¤å²›", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "JM", "title": "ç‰™ä¹°åŠ ", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "DM", "title": "å¤šç±³å°¼å…‹", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "MP", "title": "å¡ç­å²›", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "WS", "title": "è¨æ‘©äºš", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "PF", "title": "æ³•å±æ³¢åˆ©å°¼è¥¿äºš", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "LC", "title": "åœ£å¢è¥¿äºš", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "CK", "title": "åº“å…‹ç¾¤å²›", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "NU", "title": "çº½åŸƒ", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "IR", "title": "ä¼Šæœ—", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "ZM", "title": "èµæ¯”äºš", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "SR", "title": "è‹é‡Œå—", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "MV", "title": "é©¬å°”ä»£å¤«", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "KZ", "title": "å“ˆè¨å…‹æ–¯å¦", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "GA", "title": "åŠ è“¬", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "MZ", "title": "è«æ¡‘æ¯”å…‹", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "BJ", "title": "è´å®", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "AO", "title": "å®‰å“¥æ‹‰", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "GE", "title": "æ ¼é²å‰äºš", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "PS", "title": "å·´å‹’æ–¯å¦", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "TH", "title": "æ³°å›½", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "MY", "title": "é©¬æ¥è¥¿äºš", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "SG", "title": "æ–°åŠ å¡", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "LK", "title": "æ–¯é‡Œå…°å¡", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "CU", "title": "å¤å·´", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "AZ", "title": "é˜¿å¡æ‹œç–†", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "PK", "title": "å·´åŸºæ–¯å¦", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "VU", "title": "ç“¦åŠªé˜¿å›¾", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "SB", "title": "æ‰€ç½—é—¨ç¾¤å²›", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "SJ", "title": "æ–¯ç“¦å°”å·´ç¾¤å²›", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "AX", "title": "å¥¥å…°ç¾¤å²›", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "BN", "title": "æ–‡è±", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "TL", "title": "ä¸œå¸æ±¶", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "LA", "title": "è€æŒ", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "LB", "title": "é»å·´å«©", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "MM", "title": "ç¼…ç”¸", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "NP", "title": "å°¼æ³Šå°”", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "JO", "title": "çº¦æ—¦", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "BD", "title": "å­ŸåŠ æ‹‰å›½", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "EG", "title": "åŸƒåŠ", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "TG", "title": "å¤šå“¥", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "CV", "title": "ä½›å¾—è§’", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "KM", "title": "ç§‘æ‘©ç½—", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "RW", "title": "å¢æ—ºè¾¾", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "MG", "title": "é©¬è¾¾åŠ æ–¯åŠ ", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "MW", "title": "é©¬æ‹‰ç»´", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "MR", "title": "æ¯›é‡Œå¡”å°¼äºš", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "ST", "title": "åœ£å¤šç¾å’Œæ™®æ—è¥¿æ¯”", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "TZ", "title": "å¦æ¡‘å°¼äºš", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "UG", "title": "ä¹Œå¹²è¾¾", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "ZW", "title": "æ´¥å·´å¸ƒéŸ¦", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "SH", "title": "åœ£èµ«å‹’æ‹¿", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "PW", "title": "å¸•åŠ³", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "TV", "title": "å›¾ç“¦å¢", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "PG", "title": "å·´å¸ƒäºšæ–°å‡ å†…äºš", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "SA", "title": "æ²™ç‰¹é˜¿æ‹‰ä¼¯", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "KE", "title": "è‚¯å°¼äºš", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "GW", "title": "å‡ å†…äºšæ¯”ç»", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "SL", "title": "å¡æ‹‰åˆ©æ˜‚", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "ET", "title": "åŸƒå¡ä¿„æ¯”äºš", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "DJ", "title": "å‰å¸ƒæ", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "SO", "title": "ç´¢é©¬é‡Œ", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "BO", "title": "ç»åˆ©ç»´äºš", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "ID", "title": "å°åº¦å°¼è¥¿äºš", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "SN", "title": "å¡å†…åŠ å°”", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "BI", "title": "å¸ƒéš†è¿ª", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "NR", "title": "ç‘™é²", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "IQ", "title": "ä¼Šæ‹‰å…‹", "customData": "ä¸­å›½æŠ¤ç…§ç”µå­ç­¾", "color": COLORS.cn_evisa },
          { "id": "KG", "title": "å‰å°”å‰æ–¯æ–¯å¦", "customData": "ä¸­å›½æŠ¤ç…§ç”µå­ç­¾", "color": COLORS.cn_evisa },
          { "id": "TJ", "title": "å¡”å‰å…‹æ–¯å¦", "customData": "ä¸­å›½æŠ¤ç…§ç”µå­ç­¾", "color": COLORS.cn_evisa },
          { "id": "BH", "title": "å·´æ—", "customData": "ä¸­å›½æŠ¤ç…§ç”µå­ç­¾", "color": COLORS.cn_evisa },
          { "id": "GN", "title": "å‡ å†…äºš", "customData": "ä¸­å›½æŠ¤ç…§ç”µå­ç­¾", "color": COLORS.cn_evisa },
          { "id": "LS", "title": "è±ç´¢æ‰˜", "customData": "ä¸­å›½æŠ¤ç…§ç”µå­ç­¾", "color": COLORS.cn_evisa },
          { "id": "MS", "title": "è’™ç‰¹å¡æ‹‰ç‰¹", "customData": "ä¸­å›½æŠ¤ç…§ç”µå­ç­¾", "color": COLORS.cn_evisa },
          { "id": "VN", "title": "è¶Šå—", "customData": "ä¸­å›½æŠ¤ç…§ç”µå­ç­¾", "color": COLORS.cn_evisa },
          { "id": "MN", "title": "è’™å¤", "customData": "ä¸­å›½æŠ¤ç…§ç”µå­ç­¾", "color": COLORS.cn_evisa },
          { "id": "SS", "title": "å—è‹ä¸¹", "customData": "ä¸­å›½æŠ¤ç…§ç”µå­ç­¾", "color": COLORS.cn_evisa },
          { "id": "CD", "title": "åˆšæœ(é‡‘)", "customData": "ä¸­å›½æŠ¤ç…§ç”µå­ç­¾", "color": COLORS.cn_evisa },
          { "id": "NG", "title": "å°¼æ—¥åˆ©äºš", "customData": "ä¸­å›½æŠ¤ç…§ç”µå­ç­¾", "color": COLORS.cn_evisa },
          { "id": "GQ", "title": "èµ¤é“å‡ å†…äºš", "customData": "ä¸­å›½æŠ¤ç…§ç”µå­ç­¾", "color": COLORS.cn_evisa },
          { "id": "CI", "title": "ç§‘ç‰¹è¿ªç“¦", "customData": "ä¸­å›½æŠ¤ç…§ç”µå­ç­¾", "color": COLORS.cn_evisa },
          { "id": "CM", "title": "å–€éº¦éš†", "customData": "ä¸­å›½æŠ¤ç…§ç”µå­ç­¾", "color": COLORS.cn_evisa },
          { "id": "BT", "title": "ä¸ä¸¹", "customData": "ä¸­å›½æŠ¤ç…§ç”µå­ç­¾", "color": COLORS.cn_evisa },
          { "id": "BW", "title": "åšèŒ¨ç“¦çº³", "customData": "ä¸­å›½æŠ¤ç…§ç”µå­ç­¾", "color": COLORS.cn_evisa },
          { "id": "UA", "title": "ä¹Œå…‹å…°", "customData": "ä¸­å›½æŠ¤ç…§ç”µå­ç­¾", "color": COLORS.cn_evisa },
          { "id": "MD", "title": "æ‘©å°”å¤šç“¦", "customData": "ä¸­å›½æŠ¤ç…§ç”µå­ç­¾", "color": COLORS.cn_evisa },
          { "id": "ZA", "title": "å—é", "customData": "ä¸­å›½æŠ¤ç…§ç”µå­ç­¾ETA", "color": COLORS.cn_evisa }
        ]},
        "areasSettings": { "autoZoom": true, "rollOverOutlineColor": "#FFFFFF", "rollOverColor": "#334155", "rollOverAlpha": 1, "alpha": 0.9, "unlistedAreasAlpha": 0.1, "unlistedAreasColor": "#cbd5e1", "balloonText": "<div style='padding:8px; font-family: Inter, sans-serif;'><b>[[title]]</b><br/><span style='font-size:12px; opacity:0.8;'>[[customData]]</span></div>" },
        "balloon": { "adjustBorderColor": false, "color": "#ffffff", "cornerRadius": 8, "fillColor": "#1e293b", "fillAlpha": 0.95, "borderThickness": 0, "shadowAlpha": 0.15 },
        "export": { 
          "enabled": true, 
          "menu": [{ "class": "export-main", "menu": [{ "label": "å¯¼å‡ºåœ°å›¾", "menu": ["PNG", "JPG", "PDF"] }] }],
          "capture": function() {
            addWatermarkForExport('australia', true);
            return document.getElementById("chartdiv-australia");
          }
        }
      });
      
      // åˆå§‹åŒ–è°ƒè‰²ç›˜
      colorCustomizer.initColorPalette('australia', legendTitleToColorKey, COLORS);
    }

    // ç”³æ ¹ç­¾è¯åœ°å›¾
    function initSchengenMap() {
      const defaultColors = { schengen: "#3b82f6", visa_free: "#14b8a6", transit: "#60a5fa", china: "#ef4444", cn_free: "#059669", cn_arrival: "#34D399", cn_evisa: "#A7F3D0", hmt_pass: "#ff9999" };
      const COLORS = {};
      const legendTitleToColorKey = {
        "ä¸­å›½å¤§é™†": "china",
        "éœ€åŠç†æ¸¯æ¾³å°é€šè¡Œè¯": "hmt_pass",
        "ç”³æ ¹å›½": "schengen",
        "æŒç”³æ ¹ç­¾å…ç­¾": "visa_free",
        "æœ‰æ¡ä»¶è¿‡å¢ƒå…ç­¾": "transit",
        "ä¸­å›½æŠ¤ç…§å…ç­¾": "cn_free",
        "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾": "cn_arrival",
        "ä¸­å›½æŠ¤ç…§ç”µå­ç­¾": "cn_evisa"
      };
      
      for (const [key, value] of Object.entries(defaultColors)) {
        COLORS[key] = colorCustomizer.loadColor('schengen', key, value);
      }
      maps['schengen'] = AmCharts.makeChart("chartdiv-schengen", {
        "type": "map", "theme": "light", "projection": "miller",
        "dataProvider": { "map": "worldHigh", "zoomLevel": 1.2, "zoomLongitude": 20, "zoomLatitude": 30, "areas": [
          { "id": "CN", "title": "ä¸­å›½å¤§é™†", "customData": "ä¸­å›½å¤§é™†", "color": COLORS.china },
          { "id": "HK", "title": "ä¸­å›½é¦™æ¸¯", "customData": "éœ€åŠç†æ¸¯æ¾³å°é€šè¡Œè¯", "color": COLORS.hmt_pass },
          { "id": "MO", "title": "ä¸­å›½æ¾³é—¨", "customData": "éœ€åŠç†æ¸¯æ¾³å°é€šè¡Œè¯", "color": COLORS.hmt_pass },
          { "id": "TW", "title": "ä¸­å›½å°æ¹¾", "customData": "éœ€åŠç†æ¸¯æ¾³å°é€šè¡Œè¯", "color": COLORS.hmt_pass },
          { "id": "AT", "title": "å¥¥åœ°åˆ©", "customData": "ç”³æ ¹å›½", "color": COLORS.schengen },
          { "id": "BE", "title": "æ¯”åˆ©æ—¶", "customData": "ç”³æ ¹å›½", "color": COLORS.schengen },
          { "id": "CZ", "title": "æ·å…‹", "customData": "ç”³æ ¹å›½", "color": COLORS.schengen },
          { "id": "DK", "title": "ä¸¹éº¦", "customData": "ç”³æ ¹å›½", "color": COLORS.schengen },
          { "id": "EE", "title": "çˆ±æ²™å°¼äºš", "customData": "ç”³æ ¹å›½", "color": COLORS.schengen },
          { "id": "FI", "title": "èŠ¬å…°", "customData": "ç”³æ ¹å›½", "color": COLORS.schengen },
          { "id": "FR", "title": "æ³•å›½", "customData": "ç”³æ ¹å›½", "color": COLORS.schengen },
          { "id": "DE", "title": "å¾·å›½", "customData": "ç”³æ ¹å›½", "color": COLORS.schengen },
          { "id": "GR", "title": "å¸Œè…Š", "customData": "ç”³æ ¹å›½", "color": COLORS.schengen },
          { "id": "HU", "title": "åŒˆç‰™åˆ©", "customData": "ç”³æ ¹å›½", "color": COLORS.schengen },
          { "id": "IS", "title": "å†°å²›", "customData": "ç”³æ ¹å›½", "color": COLORS.schengen },
          { "id": "IT", "title": "æ„å¤§åˆ©", "customData": "ç”³æ ¹å›½", "color": COLORS.schengen },
          { "id": "LV", "title": "æ‹‰è„±ç»´äºš", "customData": "ç”³æ ¹å›½", "color": COLORS.schengen },
          { "id": "LI", "title": "åˆ—æ”¯æ•¦å£«ç™»", "customData": "ç”³æ ¹å›½", "color": COLORS.schengen },
          { "id": "LT", "title": "ç«‹é™¶å®›", "customData": "ç”³æ ¹å›½", "color": COLORS.schengen },
          { "id": "LU", "title": "å¢æ£®å ¡", "customData": "ç”³æ ¹å›½", "color": COLORS.schengen },
          { "id": "MT", "title": "é©¬è€³ä»–", "customData": "ç”³æ ¹å›½", "color": COLORS.schengen },
          { "id": "NL", "title": "è·å…°", "customData": "ç”³æ ¹å›½", "color": COLORS.schengen },
          { "id": "NO", "title": "æŒªå¨", "customData": "ç”³æ ¹å›½", "color": COLORS.schengen },
          { "id": "PL", "title": "æ³¢å…°", "customData": "ç”³æ ¹å›½", "color": COLORS.schengen },
          { "id": "PT", "title": "è‘¡è„ç‰™", "customData": "ç”³æ ¹å›½", "color": COLORS.schengen },
          { "id": "SK", "title": "æ–¯æ´›ä¼å…‹", "customData": "ç”³æ ¹å›½", "color": COLORS.schengen },
          { "id": "SI", "title": "æ–¯æ´›æ–‡å°¼äºš", "customData": "ç”³æ ¹å›½", "color": COLORS.schengen },
          { "id": "ES", "title": "è¥¿ç­ç‰™", "customData": "ç”³æ ¹å›½", "color": COLORS.schengen },
          { "id": "SE", "title": "ç‘å…¸", "customData": "ç”³æ ¹å›½", "color": COLORS.schengen },
          { "id": "CH", "title": "ç‘å£«", "customData": "ç”³æ ¹å›½", "color": COLORS.schengen },
          { "id": "BG", "title": "ä¿åŠ åˆ©äºš", "customData": "ç”³æ ¹å›½", "color": COLORS.schengen },
          { "id": "RO", "title": "ç½—é©¬å°¼äºš", "customData": "ç”³æ ¹å›½", "color": COLORS.schengen },
          { "id": "HR", "title": "å…‹ç½—åœ°äºš", "customData": "ç”³æ ¹å›½", "color": COLORS.schengen },
          { "id": "MX", "title": "å¢¨è¥¿å“¥", "customData": "æŒç”³æ ¹ç­¾å…ç­¾180å¤©", "color": COLORS.visa_free },
          { "id": "CR", "title": "å“¥æ–¯è¾¾é»åŠ ", "customData": "æŒç”³æ ¹ç­¾å…ç­¾30å¤©(éœ€Dç±»ç­¾è¯)", "color": COLORS.visa_free },
          { "id": "SV", "title": "è¨å°”ç“¦å¤š", "customData": "æŒç”³æ ¹ç­¾å…ç­¾90å¤©(æ”¶è´¹12ç¾å…ƒ)", "color": COLORS.visa_free },
          { "id": "HN", "title": "æ´ªéƒ½æ‹‰æ–¯", "customData": "æŒç”³æ ¹ç­¾å…ç­¾90å¤©", "color": COLORS.visa_free },
          { "id": "PA", "title": "å·´æ‹¿é©¬", "customData": "æŒç”³æ ¹ç­¾å…ç­¾30å¤©", "color": COLORS.visa_free },
          { "id": "PE", "title": "ç§˜é²", "customData": "æŒç”³æ ¹ç­¾å…ç­¾180å¤©", "color": COLORS.visa_free },
          { "id": "CO", "title": "å“¥ä¼¦æ¯”äºš", "customData": "æŒç”³æ ¹ç­¾å…ç­¾90å¤©", "color": COLORS.visa_free },
          { "id": "DO", "title": "å¤šç±³å°¼åŠ ", "customData": "æŒç”³æ ¹ç­¾å…ç­¾30å¤©", "color": COLORS.visa_free },
          { "id": "UY", "title": "ä¹Œæ‹‰åœ­", "customData": "æŒç”³æ ¹ç­¾å…ç­¾90å¤©", "color": COLORS.visa_free },
          { "id": "ME", "title": "é»‘å±±", "customData": "æŒç”³æ ¹ç­¾å…ç­¾30å¤©", "color": COLORS.visa_free },
          { "id": "MD", "title": "æ‘©å°”å¤šç“¦", "customData": "æŒç”³æ ¹ç­¾å…ç­¾", "color": COLORS.visa_free },
          { "id": "XK", "title": "ç§‘ç´¢æ²ƒ", "customData": "æŒç”³æ ¹ç­¾å…ç­¾(éœ€å¤šæ¬¡)", "color": COLORS.visa_free },
          { "id": "CY", "title": "å¡æµ¦è·¯æ–¯", "customData": "æŒç”³æ ¹ç­¾å…ç­¾(éœ€æœ‰æ•ˆç­¾è¯)", "color": COLORS.visa_free },
          { "id": "PH", "title": "è²å¾‹å®¾", "customData": "æŒç”³æ ¹ç­¾å…ç­¾7å¤©", "color": COLORS.visa_free },
          { "id": "KR", "title": "éŸ©å›½", "customData": "æŒç”³æ ¹ç­¾æœ‰æ¡ä»¶è¿‡å¢ƒå…ç­¾30å¤©", "color": COLORS.transit },
          { "id": "CW", "title": "åº“æ‹‰ç´¢", "customData": "æŒç”³æ ¹ç­¾å…ç­¾(éœ€å¤šæ¬¡å…¥å¢ƒ)", "color": COLORS.visa_free },
          { "id": "AW", "title": "é˜¿é²å·´", "customData": "æŒç”³æ ¹ç­¾å…ç­¾(éœ€å¤šæ¬¡å…¥å¢ƒ)", "color": COLORS.visa_free },
          { "id": "SX", "title": "è·å±åœ£é©¬ä¸", "customData": "æŒç”³æ ¹ç­¾å…ç­¾(éœ€å¤šæ¬¡å…¥å¢ƒ)", "color": COLORS.visa_free },
          { "id": "BQ", "title": "è·å±åŠ å‹’æ¯”", "customData": "æŒç”³æ ¹ç­¾å…ç­¾(éœ€å¤šæ¬¡å…¥å¢ƒ)", "color": COLORS.visa_free },
          { "id": "RU", "title": "ä¿„ç½—æ–¯", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "KH", "title": "æŸ¬åŸ”å¯¨", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "TR", "title": "åœŸè€³å…¶", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "BR", "title": "å·´è¥¿", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "AE", "title": "é˜¿è”é…‹", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "BB", "title": "å·´å·´å¤šæ–¯", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "BS", "title": "å·´å“ˆé©¬", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "BA", "title": "æ³¢é»‘", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "FJ", "title": "æ–æµ", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "GD", "title": "æ ¼æ—çº³è¾¾", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "MU", "title": "æ¯›é‡Œæ±‚æ–¯", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "SM", "title": "åœ£é©¬åŠ›è¯º", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "SC", "title": "å¡èˆŒå°”", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "RS", "title": "å¡å°”ç»´äºš", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "TO", "title": "æ±¤åŠ ", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "BY", "title": "ç™½ä¿„ç½—æ–¯", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "QA", "title": "å¡å¡”å°”", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "AM", "title": "äºšç¾å°¼äºš", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "UZ", "title": "ä¹Œå…¹åˆ«å…‹æ–¯å¦", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "OM", "title": "é˜¿æ›¼", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "AL", "title": "é˜¿å°”å·´å°¼äºš", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "MA", "title": "æ‘©æ´›å“¥", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "RE", "title": "æ³•å±ç•™å°¼æ±ª", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "TN", "title": "çªå°¼æ–¯", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾ï¼ˆéœ€æŸ¥ææ–™ï¼Œæœ‰æ¦‚ç‡æ‹’ç»å…¥å¢ƒï¼‰", "color": COLORS.cn_free },
          { "id": "AG", "title": "å®‰æç“œå’Œå·´å¸ƒè¾¾", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "HT", "title": "æµ·åœ°", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "GS", "title": "å—ä¹”æ²»äºšå’Œå—æ¡‘å¨å¥‡ç¾¤å²›", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "KN", "title": "åœ£åŸºèŒ¨å’Œå°¼ç»´æ–¯", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "TC", "title": "ç‰¹å…‹æ–¯å’Œå‡¯ç§‘æ–¯ç¾¤å²›", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "JM", "title": "ç‰™ä¹°åŠ ", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "DM", "title": "å¤šç±³å°¼å…‹", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "MP", "title": "å¡ç­å²›", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "WS", "title": "è¨æ‘©äºš", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "PF", "title": "æ³•å±æ³¢åˆ©å°¼è¥¿äºš", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "LC", "title": "åœ£å¢è¥¿äºš", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "CK", "title": "åº“å…‹ç¾¤å²›", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "NU", "title": "çº½åŸƒ", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "IR", "title": "ä¼Šæœ—", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "ZM", "title": "èµæ¯”äºš", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "SR", "title": "è‹é‡Œå—", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "MV", "title": "é©¬å°”ä»£å¤«", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "KZ", "title": "å“ˆè¨å…‹æ–¯å¦", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "GA", "title": "åŠ è“¬", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "MZ", "title": "è«æ¡‘æ¯”å…‹", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "BJ", "title": "è´å®", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "AO", "title": "å®‰å“¥æ‹‰", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "GE", "title": "æ ¼é²å‰äºš", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "PS", "title": "å·´å‹’æ–¯å¦", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "TH", "title": "æ³°å›½", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "MY", "title": "é©¬æ¥è¥¿äºš", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "SG", "title": "æ–°åŠ å¡", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "LK", "title": "æ–¯é‡Œå…°å¡", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "CU", "title": "å¤å·´", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "AZ", "title": "é˜¿å¡æ‹œç–†", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "PK", "title": "å·´åŸºæ–¯å¦", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "VU", "title": "ç“¦åŠªé˜¿å›¾", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "SB", "title": "æ‰€ç½—é—¨ç¾¤å²›", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "SJ", "title": "æ–¯ç“¦å°”å·´ç¾¤å²›", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "AX", "title": "å¥¥å…°ç¾¤å²›", "customData": "ä¸­å›½æŠ¤ç…§å…ç­¾", "color": COLORS.cn_free },
          { "id": "BN", "title": "æ–‡è±", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "TL", "title": "ä¸œå¸æ±¶", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "LA", "title": "è€æŒ", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "LB", "title": "é»å·´å«©", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "MM", "title": "ç¼…ç”¸", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "NP", "title": "å°¼æ³Šå°”", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "JO", "title": "çº¦æ—¦", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "BD", "title": "å­ŸåŠ æ‹‰å›½", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "EG", "title": "åŸƒåŠ", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "TG", "title": "å¤šå“¥", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "CV", "title": "ä½›å¾—è§’", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "KM", "title": "ç§‘æ‘©ç½—", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "RW", "title": "å¢æ—ºè¾¾", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "MG", "title": "é©¬è¾¾åŠ æ–¯åŠ ", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "MW", "title": "é©¬æ‹‰ç»´", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "MR", "title": "æ¯›é‡Œå¡”å°¼äºš", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "ST", "title": "åœ£å¤šç¾å’Œæ™®æ—è¥¿æ¯”", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "TZ", "title": "å¦æ¡‘å°¼äºš", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "UG", "title": "ä¹Œå¹²è¾¾", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "ZW", "title": "æ´¥å·´å¸ƒéŸ¦", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "SH", "title": "åœ£èµ«å‹’æ‹¿", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "PW", "title": "å¸•åŠ³", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "TV", "title": "å›¾ç“¦å¢", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "PG", "title": "å·´å¸ƒäºšæ–°å‡ å†…äºš", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "SA", "title": "æ²™ç‰¹é˜¿æ‹‰ä¼¯", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "KE", "title": "è‚¯å°¼äºš", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "GW", "title": "å‡ å†…äºšæ¯”ç»", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "SL", "title": "å¡æ‹‰åˆ©æ˜‚", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "ET", "title": "åŸƒå¡ä¿„æ¯”äºš", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "DJ", "title": "å‰å¸ƒæ", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "SO", "title": "ç´¢é©¬é‡Œ", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "BO", "title": "ç»åˆ©ç»´äºš", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "ID", "title": "å°åº¦å°¼è¥¿äºš", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "SN", "title": "å¡å†…åŠ å°”", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "BI", "title": "å¸ƒéš†è¿ª", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "NR", "title": "ç‘™é²", "customData": "ä¸­å›½æŠ¤ç…§è½åœ°ç­¾", "color": COLORS.cn_arrival },
          { "id": "IQ", "title": "ä¼Šæ‹‰å…‹", "customData": "ä¸­å›½æŠ¤ç…§ç”µå­ç­¾", "color": COLORS.cn_evisa },
          { "id": "KG", "title": "å‰å°”å‰æ–¯æ–¯å¦", "customData": "ä¸­å›½æŠ¤ç…§ç”µå­ç­¾", "color": COLORS.cn_evisa },
          { "id": "TJ", "title": "å¡”å‰å…‹æ–¯å¦", "customData": "ä¸­å›½æŠ¤ç…§ç”µå­ç­¾", "color": COLORS.cn_evisa },
          { "id": "BH", "title": "å·´æ—", "customData": "ä¸­å›½æŠ¤ç…§ç”µå­ç­¾", "color": COLORS.cn_evisa },
          { "id": "GN", "title": "å‡ å†…äºš", "customData": "ä¸­å›½æŠ¤ç…§ç”µå­ç­¾", "color": COLORS.cn_evisa },
          { "id": "LS", "title": "è±ç´¢æ‰˜", "customData": "ä¸­å›½æŠ¤ç…§ç”µå­ç­¾", "color": COLORS.cn_evisa },
          { "id": "MS", "title": "è’™ç‰¹å¡æ‹‰ç‰¹", "customData": "ä¸­å›½æŠ¤ç…§ç”µå­ç­¾", "color": COLORS.cn_evisa },
          { "id": "VN", "title": "è¶Šå—", "customData": "ä¸­å›½æŠ¤ç…§ç”µå­ç­¾", "color": COLORS.cn_evisa },
          { "id": "MN", "title": "è’™å¤", "customData": "ä¸­å›½æŠ¤ç…§ç”µå­ç­¾", "color": COLORS.cn_evisa },
          { "id": "SS", "title": "å—è‹ä¸¹", "customData": "ä¸­å›½æŠ¤ç…§ç”µå­ç­¾", "color": COLORS.cn_evisa },
          { "id": "CD", "title": "åˆšæœ(é‡‘)", "customData": "ä¸­å›½æŠ¤ç…§ç”µå­ç­¾", "color": COLORS.cn_evisa },
          { "id": "NG", "title": "å°¼æ—¥åˆ©äºš", "customData": "ä¸­å›½æŠ¤ç…§ç”µå­ç­¾", "color": COLORS.cn_evisa },
          { "id": "GQ", "title": "èµ¤é“å‡ å†…äºš", "customData": "ä¸­å›½æŠ¤ç…§ç”µå­ç­¾", "color": COLORS.cn_evisa },
          { "id": "CI", "title": "ç§‘ç‰¹è¿ªç“¦", "customData": "ä¸­å›½æŠ¤ç…§ç”µå­ç­¾", "color": COLORS.cn_evisa },
          { "id": "CM", "title": "å–€éº¦éš†", "customData": "ä¸­å›½æŠ¤ç…§ç”µå­ç­¾", "color": COLORS.cn_evisa },
          { "id": "BT", "title": "ä¸ä¸¹", "customData": "ä¸­å›½æŠ¤ç…§ç”µå­ç­¾", "color": COLORS.cn_evisa },
          { "id": "BW", "title": "åšèŒ¨ç“¦çº³", "customData": "ä¸­å›½æŠ¤ç…§ç”µå­ç­¾", "color": COLORS.cn_evisa },
          { "id": "UA", "title": "ä¹Œå…‹å…°", "customData": "ä¸­å›½æŠ¤ç…§ç”µå­ç­¾", "color": COLORS.cn_evisa },
          { "id": "MD", "title": "æ‘©å°”å¤šç“¦", "customData": "ä¸­å›½æŠ¤ç…§ç”µå­ç­¾", "color": COLORS.cn_evisa },
          { "id": "ZA", "title": "å—é", "customData": "ä¸­å›½æŠ¤ç…§ç”µå­ç­¾ETA", "color": COLORS.cn_evisa }
        ]},
        "areasSettings": { "autoZoom": true, "rollOverOutlineColor": "#FFFFFF", "rollOverColor": "#334155", "rollOverAlpha": 1, "alpha": 0.9, "unlistedAreasAlpha": 0.1, "unlistedAreasColor": "#cbd5e1", "balloonText": "<div style='padding:8px; font-family: Inter, sans-serif;'><b>[[title]]</b><br/><span style='font-size:12px; opacity:0.8;'>[[customData]]</span></div>" },
        "balloon": { "adjustBorderColor": false, "color": "#ffffff", "cornerRadius": 8, "fillColor": "#1e293b", "fillAlpha": 0.95, "borderThickness": 0, "shadowAlpha": 0.15 },
        "export": { 
          "enabled": true, 
          "menu": [{ "class": "export-main", "menu": [{ "label": "å¯¼å‡ºåœ°å›¾", "menu": ["PNG", "JPG", "PDF"] }] }],
          "capture": function() {
            addWatermarkForExport('schengen', true);
            return document.getElementById("chartdiv-schengen");
          }
        }
      });
      
      // åˆå§‹åŒ–è°ƒè‰²ç›˜
      colorCustomizer.initColorPalette('schengen', legendTitleToColorKey, COLORS);
    }

    // è®¿é—®ç»Ÿè®¡åœ°å›¾
    async function initAnalyticsMap() {
      // æ¸…é™¤æ—§çš„åœ°å›¾å®ä¾‹
      if (maps['analytics']) {
        maps['analytics'].clear();
        delete maps['analytics'];
      }
      
      // ä»Firebaseè·å–èšåˆç»Ÿè®¡æ•°æ®
      const aggregatedData = await visitTracker.getAggregatedStats();
      
      if (!aggregatedData) {
        // å¦‚æœæ²¡æœ‰èšåˆæ•°æ®ï¼Œæ˜¾ç¤ºæç¤º
        const chartDiv = document.getElementById('chartdiv-analytics');
        if (chartDiv) {
          chartDiv.innerHTML = `
            <div style="display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100%; padding: 40px; text-align: center;">
              <div style="font-size: 18px; color: #64748b; margin-bottom: 10px;">æš‚æ— è®¿é—®æ•°æ®</div>
              <div style="font-size: 14px; color: #94a3b8; margin-bottom: 20px;">è®¿é—®æ•°æ®å°†åœ¨æ‚¨æµè§ˆç½‘ç«™æ—¶è‡ªåŠ¨æ”¶é›†</div>
              <div style="font-size: 12px; color: #cbd5e1; line-height: 1.6;">
                <div>å¦‚æœæŒç»­æ˜¾ç¤ºæ­¤æç¤ºï¼Œè¯·æ£€æŸ¥ï¼š</div>
                <div style="margin-top: 8px;">1. Firestore å®‰å…¨è§„åˆ™æ˜¯å¦å…è®¸è¯»å– visits é›†åˆ</div>
                <div style="margin-top: 4px;">2. æµè§ˆå™¨æ§åˆ¶å°æ˜¯å¦æœ‰é”™è¯¯ä¿¡æ¯</div>
              </div>
            </div>
          `;
        }
        document.getElementById('stat-total').textContent = '0';
        document.getElementById('stat-unique').textContent = '0';
        document.getElementById('stat-countries').textContent = '0';
        document.getElementById('stat-top-countries').innerHTML = '<div style="color: #64748b;">ç­‰å¾…æ•°æ®èšåˆ...</div>';
        document.getElementById('stat-top-cities').innerHTML = '<div style="color: #64748b;">ç­‰å¾…æ•°æ®èšåˆ...</div>';
        return;
      }
      
      // æ›´æ–°ç»Ÿè®¡æ•°æ®æ˜¾ç¤º
      document.getElementById('stat-total').textContent = aggregatedData.totalVisits || 0;
      document.getElementById('stat-unique').textContent = aggregatedData.uniqueIPs || 0;
      document.getElementById('stat-countries').textContent = aggregatedData.countriesCount || Object.keys(aggregatedData.countries || {}).length;
      
      // æ˜¾ç¤ºè®¿é—®æœ€å¤šçš„å›½å®¶
      const topCountriesDiv = document.getElementById('stat-top-countries');
      if (aggregatedData.topCountries && aggregatedData.topCountries.length > 0) {
        topCountriesDiv.innerHTML = aggregatedData.topCountries.map(item => 
          `<div style="display: flex; justify-content: space-between; padding: 5px 0; border-bottom: 1px solid #e2e8f0;">
            <span>${item.country}</span>
            <span style="font-weight: 600; color: #3b82f6;">${item.count}</span>
          </div>`
        ).join('');
      } else {
        topCountriesDiv.innerHTML = '<div style="color: #64748b;">æš‚æ— æ•°æ®</div>';
      }
      
      // æ˜¾ç¤ºè®¿é—®æœ€å¤šçš„åŸå¸‚
      const topCitiesDiv = document.getElementById('stat-top-cities');
      if (aggregatedData.topCities && aggregatedData.topCities.length > 0) {
        topCitiesDiv.innerHTML = aggregatedData.topCities.map(item => 
          `<div style="display: flex; justify-content: space-between; padding: 5px 0; border-bottom: 1px solid #e2e8f0;">
            <span>${item.city}</span>
            <span style="font-weight: 600; color: #3b82f6;">${item.count}</span>
          </div>`
        ).join('');
      } else {
        topCitiesDiv.innerHTML = '<div style="color: #64748b;">æš‚æ— æ•°æ®</div>';
      }
      
      // åˆ›å»ºè®¿é—®åˆ†å¸ƒåœ°å›¾
      let countryVisits = aggregatedData.countryVisits || {};
      if (Object.keys(countryVisits).length === 0) {
        const chartDiv = document.getElementById('chartdiv-analytics');
        if (chartDiv) {
          chartDiv.innerHTML = '<div style="display: flex; align-items: center; justify-content: center; height: 100%; font-size: 18px; color: #64748b;">æš‚æ— è®¿é—®æ•°æ®</div>';
        }
        return;
      }
      
      // æ¸…ç†æ•°æ®ï¼šå°† XX å’Œ Unknown åˆå¹¶åˆ°ä¸­å›½ï¼ˆCNï¼‰
      const cleanedCountryVisits = {};
      Object.keys(countryVisits).forEach(countryCode => {
        const data = countryVisits[countryCode];
        let targetCode = countryCode;
        let targetCountry = data.country || 'China';
        
        // å¦‚æœ countryCode æ˜¯ XX æˆ– country æ˜¯ Unknownï¼Œæ˜ å°„åˆ°ä¸­å›½
        if (countryCode === 'XX' || data.country === 'Unknown' || !countryCode || !data.country) {
          targetCode = 'CN';
          targetCountry = 'China';
        }
        
        // åˆå¹¶åˆ°ç›®æ ‡å›½å®¶ä»£ç 
        if (!cleanedCountryVisits[targetCode]) {
          cleanedCountryVisits[targetCode] = {
            count: 0,
            country: targetCountry
          };
        }
        cleanedCountryVisits[targetCode].count += (data.count || 0);
      });
      countryVisits = cleanedCountryVisits;
      
      // åˆ›å»ºåœ°å›¾åŒºåŸŸæ•°æ®
      const maxCount = Math.max(...Object.values(countryVisits).map(d => d.count || 0));
      const areas = Object.keys(countryVisits).map(countryCode => {
        const data = countryVisits[countryCode];
        // æ ¹æ®è®¿é—®æ¬¡æ•°è®¾ç½®é¢œè‰²æ·±åº¦
        const intensity = maxCount > 0 ? Math.min((data.count || 0) / maxCount, 1) : 0;
        const color = `rgb(${Math.floor(59 + (196 - 59) * (1 - intensity))}, ${Math.floor(130 + (196 - 130) * (1 - intensity))}, ${Math.floor(246 - 246 * intensity)})`;
        
        return {
          id: countryCode,
          title: data.country || 'China',
          customData: `${data.count || 0} æ¬¡è®¿é—®`,
          color: color,
          value: data.count || 0
        };
      });
      
      maps['analytics'] = AmCharts.makeChart("chartdiv-analytics", {
        "type": "map",
        "theme": "light",
        "projection": "miller",
        "dataProvider": {
          "map": "worldHigh",
          "zoomLevel": 1.2,
          "zoomLongitude": 20,
          "zoomLatitude": 30,
          "areas": areas
        },
        "areasSettings": {
          "autoZoom": true,
          "rollOverOutlineColor": "#FFFFFF",
          "rollOverColor": "#334155",
          "rollOverAlpha": 1,
          "alpha": 0.9,
          "unlistedAreasAlpha": 0.1,
          "unlistedAreasColor": "#cbd5e1",
          "balloonText": "<div style='padding:10px; font-family: Inter, sans-serif; line-height:1.6;'><b style='font-size:14px;'>[[title]]</b><br/><span style='font-size:12px; opacity:0.9; margin-top:5px; display:block;'>[[customData]]</span></div>"
        },
        "balloon": {
          "adjustBorderColor": false,
          "color": "#ffffff",
          "cornerRadius": 8,
          "fillColor": "#1e293b",
          "fillAlpha": 0.95,
          "borderThickness": 0,
          "shadowAlpha": 0.15
        },
        "export": {
          "enabled": true,
          "menu": [{
            "class": "export-main",
            "menu": [{
              "label": "å¯¼å‡ºåœ°å›¾",
              "menu": ["PNG", "JPG", "PDF"]
            }]
          }],
          "capture": function() {
            addWatermarkForExport('analytics', true);
            return document.getElementById("chartdiv-analytics");
          }
        }
      });
      
      // æ·»åŠ æ°´å°æ–‡æœ¬åˆ°åœ°å›¾ï¼ˆç”¨äºæ˜¾ç¤ºï¼‰
      addWatermarkForExport('analytics');
    }

    // åˆå§‹åŒ–é»˜è®¤æ˜¾ç¤ºçš„åœ°å›¾
    initMap('global');
  </script>
</body>
</html>
