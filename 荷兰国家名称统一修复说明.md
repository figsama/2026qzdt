# 荷兰国家名称统一修复

## 问题描述
过去被统计的荷兰数据存在不一致的问题：
- "the netherland"
- "netherland"
- "holland"
- "nl"
- "netherlands"

这些不同的变体导致荷兰被错误地统计为多个国家。

## 解决方案

### 1. 前端修复 (index.html)
在 `visitTracker.normalizeCountryName()` 函数中添加了国家名称标准化逻辑：
- 荷兰的所有变体都会被统一为"荷兰"
- 支持40+个国家的名称标准化

### 2. 后端修复 (diagnose_and_fix.js)
在数据修复脚本中添加了相同的标准化逻辑：
- 可以修正历史数据中的国家名称不一致问题
- 支持批量修复所有受影响的记录

### 3. 测试工具
- `test_netherlands_fix.sh`: 本地测试脚本，验证标准化功能
- `fix_netherlands.sh`: 修复脚本包装器

## 修复内容

### 荷兰变体统一
```
"the netherland" -> "荷兰"
"netherland" -> "荷兰"
"holland" -> "荷兰"
"nl" -> "荷兰"
"netherlands" -> "荷兰"
```

### 其他国家标准化
支持以下国家的常见变体：
- 美国: united states, usa, us, america
- 英国: united kingdom, uk, great britain, england
- 中国: china
- 日本: japan
- 韩国: korea, south korea
- 德国: germany
- 法国: france
- 意大利: italy
- 西班牙: spain
- 加拿大: canada
- 澳大利亚: australia
- 新加坡: singapore
- 泰国: thailand
- 越南: vietnam
- 印度尼西亚: indonesia
- 马来西亚: malaysia
- 菲律宾: philippines
- 印度: india
- 俄罗斯: russia
- 巴西: brazil
- 墨西哥: mexico
- 阿根廷: argentina
- 智利: chile
- 秘鲁: peru
- 哥伦比亚: colombia
- 土耳其: turkey
- 沙特阿拉伯: saudi arabia
- 阿联酋: uae, united arab emirates
- 南非: south africa
- 埃及: egypt
- 摩洛哥: morocco
- 尼日利亚: nigeria
- 肯尼亚: kenya
- 加纳: ghana
- 埃塞俄比亚: ethiopia

## 使用方法

### 前端自动修复
访问网站时，新访问记录的国家名称会自动标准化。

### 历史数据修复
当Firebase连接正常时，可以运行以下命令：

```bash
# 模拟运行（查看将要修复的记录）
node diagnose_and_fix.js --fix --dry-run

# 实际修复数据
node diagnose_and_fix.js --fix
```

### 本地测试
```bash
# 运行本地测试脚本
./test_netherlands_fix.sh
```

## 注意事项
- 需要有效的代理连接才能访问Firebase
- 如果代理连接有问题，请先运行 `./setup_proxy.sh`
- 修复脚本会批量处理所有受影响的记录
- 建议先运行模拟模式确认修复内容

## 修复状态
✅ 前端国家名称标准化功能已实现
✅ 后端数据修复脚本已更新
✅ 测试工具已创建
⏳ 历史数据修复需要有效的Firebase连接
